<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 데이터 변환 | 경영빅데이터분석 참고자료 - R 기초</title>
  <meta name="description" content="이 책은 경영빅데이터분석의 참고자료로 활용하기 위해 제작되었습니다." />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 데이터 변환 | 경영빅데이터분석 참고자료 - R 기초" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="이 책은 경영빅데이터분석의 참고자료로 활용하기 위해 제작되었습니다." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 데이터 변환 | 경영빅데이터분석 참고자료 - R 기초" />
  
  <meta name="twitter:description" content="이 책은 경영빅데이터분석의 참고자료로 활용하기 위해 제작되었습니다." />
  

<meta name="author" content="김길환" />


<meta name="date" content="2023-03-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-R-Data-Structure.html"/>
<link rel="next" href="ch-visualization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">경영빅데이터분석-R기초</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>일러두기</a></li>
<li class="chapter" data-level="1" data-path="ch-intro.html"><a href="ch-intro.html"><i class="fa fa-check"></i><b>1</b> R 설치 및 시작</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch-intro.html"><a href="ch-intro.html#sec-Rintro"><i class="fa fa-check"></i><b>1.1</b> R 소개</a></li>
<li class="chapter" data-level="1.2" data-path="ch-intro.html"><a href="ch-intro.html#sec-installation"><i class="fa fa-check"></i><b>1.2</b> R 설치하기</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ch-intro.html"><a href="ch-intro.html#r-배포판-내려받기"><i class="fa fa-check"></i><b>1.2.1</b> R 배포판 내려받기</a></li>
<li class="chapter" data-level="1.2.2" data-path="ch-intro.html"><a href="ch-intro.html#설치에-앞서-주의할-사항"><i class="fa fa-check"></i><b>1.2.2</b> 설치에 앞서 주의할 사항</a></li>
<li class="chapter" data-level="1.2.3" data-path="ch-intro.html"><a href="ch-intro.html#r-설치하기"><i class="fa fa-check"></i><b>1.2.3</b> R 설치하기</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ch-intro.html"><a href="ch-intro.html#sec-RStudio"><i class="fa fa-check"></i><b>1.3</b> RStudio</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ch-intro.html"><a href="ch-intro.html#rstudio-설치"><i class="fa fa-check"></i><b>1.3.1</b> RStudio 설치</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ch-intro.html"><a href="ch-intro.html#sec-R-start"><i class="fa fa-check"></i><b>1.4</b> RStudio로 R 시작하기</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="ch-intro.html"><a href="ch-intro.html#r-콘솔과-프롬프트"><i class="fa fa-check"></i><b>1.4.1</b> R 콘솔과 프롬프트</a></li>
<li class="chapter" data-level="1.4.2" data-path="ch-intro.html"><a href="ch-intro.html#r-콘솔-사용과-관련된-몇-가지-팁"><i class="fa fa-check"></i><b>1.4.2</b> R 콘솔 사용과 관련된 몇 가지 팁</a></li>
<li class="chapter" data-level="1.4.3" data-path="ch-intro.html"><a href="ch-intro.html#r-스크립트-파일-만들기"><i class="fa fa-check"></i><b>1.4.3</b> R 스크립트 파일 만들기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html"><i class="fa fa-check"></i><b>2</b> R 데이터 형식과 변수</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#sec-simpleDataType"><i class="fa fa-check"></i><b>2.1</b> 단순한 데이터 형식</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#r의-기본적-데이터-형식-숫자-문자열-논리값"><i class="fa fa-check"></i><b>2.1.1</b> R의 기본적 데이터 형식: 숫자, 문자열, 논리값</a></li>
<li class="chapter" data-level="2.1.2" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#vs-10"><i class="fa fa-check"></i><b>2.1.2</b> 10 vs “10”</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#sec-simpleOperation"><i class="fa fa-check"></i><b>2.2</b> 숫자 연산</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#사칙-연산"><i class="fa fa-check"></i><b>2.2.1</b> 사칙 연산</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#거듭-제곱-연산"><i class="fa fa-check"></i><b>2.2.2</b> 거듭 제곱 연산</a></li>
<li class="chapter" data-level="2.2.3" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#몫과-나머지"><i class="fa fa-check"></i><b>2.2.3</b> 몫과 나머지</a></li>
<li class="chapter" data-level="2.2.4" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#비교-연산-그리고-vs."><i class="fa fa-check"></i><b>2.2.4</b> 비교 연산 그리고 <code>==</code> vs. <code>=</code></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#논리값-연산"><i class="fa fa-check"></i><b>2.3</b> 논리값 연산</a></li>
<li class="chapter" data-level="2.4" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#문자열-연산"><i class="fa fa-check"></i><b>2.4</b> 문자열 연산</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#문자열-결합-연산-paste"><i class="fa fa-check"></i><b>2.4.1</b> 문자열 결합 연산: <code>paste()</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#문자열-분리-연산-strsplit"><i class="fa fa-check"></i><b>2.4.2</b> 문자열 분리 연산: <code>strsplit()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#sec-variable"><i class="fa fa-check"></i><b>2.5</b> 변수와 할당</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#변수는-메모리-공간에-붙이는-레이블"><i class="fa fa-check"></i><b>2.5.1</b> 변수는 메모리 공간에 붙이는 레이블</a></li>
<li class="chapter" data-level="2.5.2" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#변수명에-대한-규칙"><i class="fa fa-check"></i><b>2.5.2</b> 변수명에 대한 규칙</a></li>
<li class="chapter" data-level="2.5.3" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#변수에-값-할당하기"><i class="fa fa-check"></i><b>2.5.3</b> 변수에 값 할당하기</a></li>
<li class="chapter" data-level="2.5.4" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#할당-연산자"><i class="fa fa-check"></i><b>2.5.4</b> 할당 연산자</a></li>
<li class="chapter" data-level="2.5.5" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#연산에-변수-사용하기"><i class="fa fa-check"></i><b>2.5.5</b> 연산에 변수 사용하기</a></li>
<li class="chapter" data-level="2.5.6" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#변수에-값-재할당하기"><i class="fa fa-check"></i><b>2.5.6</b> 변수에 값 재할당하기</a></li>
<li class="chapter" data-level="2.5.7" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#할당문은-우변이-수행된-후-좌변으로-할당이-이루어진다."><i class="fa fa-check"></i><b>2.5.7</b> 할당문은 우변이 수행된 후 좌변으로 할당이 이루어진다.</a></li>
<li class="chapter" data-level="2.5.8" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#변수-제거하기-rm"><i class="fa fa-check"></i><b>2.5.8</b> 변수 제거하기: <code>rm()</code></a></li>
<li class="chapter" data-level="2.5.9" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#변수-목록-확인하기-ls"><i class="fa fa-check"></i><b>2.5.9</b> 변수 목록 확인하기: <code>ls()</code></a></li>
<li class="chapter" data-level="2.5.10" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#변수를-할당하는-또-다른-방법-assign"><i class="fa fa-check"></i><b>2.5.10</b> 변수를 할당하는 또 다른 방법: <code>assign()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#sec-useFunctions"><i class="fa fa-check"></i><b>2.6</b> 함수를 이용한 연산</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#함수-호출-하기"><i class="fa fa-check"></i><b>2.6.1</b> 함수 호출 하기</a></li>
<li class="chapter" data-level="2.6.2" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#실수를-정수로-변환하는-함수"><i class="fa fa-check"></i><b>2.6.2</b> 실수를 정수로 변환하는 함수</a></li>
<li class="chapter" data-level="2.6.3" data-path="ch-RDataBasic.html"><a href="ch-RDataBasic.html#순열과-조합-함수"><i class="fa fa-check"></i><b>2.6.3</b> 순열과 조합 함수</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html"><i class="fa fa-check"></i><b>3</b> R 데이터 구조</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#sec-vectors"><i class="fa fa-check"></i><b>3.1</b> 벡터</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#벡터는-동일-형식-데이터의-나열"><i class="fa fa-check"></i><b>3.1.1</b> 벡터는 동일 형식 데이터의 나열</a></li>
<li class="chapter" data-level="3.1.2" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#벡터를-생성하는-법"><i class="fa fa-check"></i><b>3.1.2</b> 벡터를 생성하는 법</a></li>
<li class="chapter" data-level="3.1.3" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#sec-vectorOperation"><i class="fa fa-check"></i><b>3.1.3</b> 벡터의 연산</a></li>
<li class="chapter" data-level="3.1.4" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#벡터의-필터링인덱싱"><i class="fa fa-check"></i><b>3.1.4</b> 벡터의 필터링/인덱싱</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#sec-matrices"><i class="fa fa-check"></i><b>3.2</b> 행렬과 배열</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#행렬과-배열은-다차원적-데이터-구조"><i class="fa fa-check"></i><b>3.2.1</b> 행렬과 배열은 다차원적 데이터 구조</a></li>
<li class="chapter" data-level="3.2.2" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#행렬과-배열의-필요성"><i class="fa fa-check"></i><b>3.2.2</b> 행렬과 배열의 필요성</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#sec-lists"><i class="fa fa-check"></i><b>3.3</b> 리스트</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#리스트-이해의-중요성"><i class="fa fa-check"></i><b>3.3.1</b> 리스트 이해의 중요성</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#sec-dataFrames"><i class="fa fa-check"></i><b>3.4</b> 데이터 프레임</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#데이터-프레임의-열변수은-벡터이다."><i class="fa fa-check"></i><b>3.4.1</b> 데이터 프레임의 열(변수)은 벡터이다.</a></li>
<li class="chapter" data-level="3.4.2" data-path="ch-R-Data-Structure.html"><a href="ch-R-Data-Structure.html#데이터-프레임의-문법과-조작"><i class="fa fa-check"></i><b>3.4.2</b> 데이터 프레임의 문법과 조작</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html"><i class="fa fa-check"></i><b>4</b> 데이터 변환</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-tidyData"><i class="fa fa-check"></i><b>4.1</b> 정돈 데이터 (tidy data)</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#정돈-데이터-형식의-조건"><i class="fa fa-check"></i><b>4.1.1</b> 정돈 데이터 형식의 조건</a></li>
<li class="chapter" data-level="4.1.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#비정돈-데이터-형식"><i class="fa fa-check"></i><b>4.1.2</b> 비정돈 데이터 형식</a></li>
<li class="chapter" data-level="4.1.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#정돈-데이터를-사용하는-이유"><i class="fa fa-check"></i><b>4.1.3</b> 정돈 데이터를 사용하는 이유</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#tidyverse-패키지"><i class="fa fa-check"></i><b>4.2</b> <code>tidyverse</code> 패키지</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#tidyverse-패키지-설치"><i class="fa fa-check"></i><b>4.2.1</b> <code>tidyverse</code> 패키지 설치</a></li>
<li class="chapter" data-level="4.2.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#tidyverse-패키지-적재"><i class="fa fa-check"></i><b>4.2.2</b> <code>tidyverse</code> 패키지 적재</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-dplyr"><i class="fa fa-check"></i><b>4.3</b> <code>dplyr</code> 패키지와 정돈 데이터의 변환</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#dplyr-패키지"><i class="fa fa-check"></i><b>4.3.1</b> <code>dplyr</code> 패키지</a></li>
<li class="chapter" data-level="4.3.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#정돈-데이터-변환의-종류"><i class="fa fa-check"></i><b>4.3.2</b> 정돈 데이터 변환의 종류</a></li>
<li class="chapter" data-level="4.3.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#dplyr-패키지-vs.-r의-기본-기능"><i class="fa fa-check"></i><b>4.3.3</b> <code>dplyr</code> 패키지 vs. R의 기본 기능</a></li>
<li class="chapter" data-level="4.3.4" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#mpg-데이터"><i class="fa fa-check"></i><b>4.3.4</b> <code>mpg</code> 데이터</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-filter"><i class="fa fa-check"></i><b>4.4</b> <code>filter()</code>로 행 선택하기</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#선택-조건이-하나인-경우"><i class="fa fa-check"></i><b>4.4.1</b> 선택 조건이 하나인 경우</a></li>
<li class="chapter" data-level="4.4.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#여러-조건을-만족하는-행-추출하기"><i class="fa fa-check"></i><b>4.4.2</b> 여러 조건을 만족하는 행 추출하기</a></li>
<li class="chapter" data-level="4.4.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#논리-연산자로-복합-조건-만들기"><i class="fa fa-check"></i><b>4.4.3</b> 논리 연산자로 복합 조건 만들기</a></li>
<li class="chapter" data-level="4.4.4" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#in-연산자"><i class="fa fa-check"></i><b>4.4.4</b> <code>%in%</code> 연산자</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-slice"><i class="fa fa-check"></i><b>4.5</b> <code>slice()</code>로 행 선택하기</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#slice_sample로-표본-추출하기"><i class="fa fa-check"></i><b>4.5.1</b> <code>slice_sample()</code>로 표본 추출하기</a></li>
<li class="chapter" data-level="4.5.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#slice_head와-slice_tail"><i class="fa fa-check"></i><b>4.5.2</b> <code>slice_head()</code>와 <code>slice_tail()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#slice_min과-slice_max"><i class="fa fa-check"></i><b>4.5.3</b> <code>slice_min()</code>과 <code>slice_max()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-arrange"><i class="fa fa-check"></i><b>4.6</b> <code>arrange()</code>로 행 정렬하기</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#desc를-이용하여-내림차순으로-정렬하기"><i class="fa fa-check"></i><b>4.6.1</b> <code>desc()</code>를 이용하여 내림차순으로 정렬하기</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-select"><i class="fa fa-check"></i><b>4.7</b> <code>select()</code>를 이용하여 변수 이름으로 열 선택하기</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-이름을-나열하여-선택하기"><i class="fa fa-check"></i><b>4.7.1</b> 변수 이름을 나열하여 선택하기</a></li>
<li class="chapter" data-level="4.7.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-이름으로-변수-범위를-선택하기"><i class="fa fa-check"></i><b>4.7.2</b> 변수 이름으로 변수 범위를 선택하기</a></li>
<li class="chapter" data-level="4.7.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-위치로-매칭하여-선택하기"><i class="fa fa-check"></i><b>4.7.3</b> 변수 위치로 매칭하여 선택하기</a></li>
<li class="chapter" data-level="4.7.4" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-이름을-매칭하여-선택하기"><i class="fa fa-check"></i><b>4.7.4</b> 변수 이름을 매칭하여 선택하기</a></li>
<li class="chapter" data-level="4.7.5" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수의-형식이나-조건으로-매칭하여-선택하기"><i class="fa fa-check"></i><b>4.7.5</b> 변수의 형식이나 조건으로 매칭하여 선택하기*</a></li>
<li class="chapter" data-level="4.7.6" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-이름-바꾸기"><i class="fa fa-check"></i><b>4.7.6</b> 변수 이름 바꾸기</a></li>
<li class="chapter" data-level="4.7.7" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-순서-바꾸기"><i class="fa fa-check"></i><b>4.7.7</b> 변수 순서 바꾸기</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-mutate"><i class="fa fa-check"></i><b>4.8</b> <code>mutate()</code>로 새로운 변수 만들기</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#transmute로-새로운-변수만-남기기"><i class="fa fa-check"></i><b>4.8.1</b> <code>transmute()</code>로 새로운 변수만 남기기</a></li>
<li class="chapter" data-level="4.8.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#새로운-변수를-만들-때-사용할-수-있는-함수들"><i class="fa fa-check"></i><b>4.8.2</b> 새로운 변수를 만들 때 사용할 수 있는 함수들</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-summarize"><i class="fa fa-check"></i><b>4.9</b> <code>summarize()</code>로 변수 요약하기</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#across로-여려-변수를-요약하기"><i class="fa fa-check"></i><b>4.9.1</b> <code>across()</code>로 여려 변수를 요약하기*</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-groupBy"><i class="fa fa-check"></i><b>4.10</b> <code>group_by()</code>로 그룹별로 요약하기</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#group_by로-그룹별로-새-변수-추가하기"><i class="fa fa-check"></i><b>4.10.1</b> <code>group_by()</code>로 그룹별로 새 변수 추가하기</a></li>
<li class="chapter" data-level="4.10.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#count로-개수-세기"><i class="fa fa-check"></i><b>4.10.2</b> <code>count()</code>로 개수 세기</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-pipeOperator"><i class="fa fa-check"></i><b>4.11</b> <code>%&gt;%</code> 파이프 연산자</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#여러-단계를-거쳐-데이터를-변환할-때"><i class="fa fa-check"></i><b>4.11.1</b> 여러 단계를 거쳐 데이터를 변환할 때</a></li>
<li class="chapter" data-level="4.11.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#파이프-연산자"><i class="fa fa-check"></i><b>4.11.2</b> 파이프 연산자</a></li>
<li class="chapter" data-level="4.11.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#ungroup"><i class="fa fa-check"></i><b>4.11.3</b> <code>ungroup()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-visualization.html"><a href="ch-visualization.html"><i class="fa fa-check"></i><b>5</b> R 데이터 시각화 기초</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ch-visualization.html"><a href="ch-visualization.html#ggplot2-패키지-설치하기"><i class="fa fa-check"></i><b>5.1</b> ggplot2 패키지 설치하기</a></li>
<li class="chapter" data-level="5.2" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-getStarted-ggplot2"><i class="fa fa-check"></i><b>5.2</b> ggplot2 시작하기</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ch-visualization.html"><a href="ch-visualization.html#subsec-tryGgplot"><i class="fa fa-check"></i><b>5.2.1</b> ggplot2 그래프의 기본 문법</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-aesMapping"><i class="fa fa-check"></i><b>5.3</b> 그래프 속성과 데이터 열 매핑하기 (aesthetic mapping)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ch-visualization.html"><a href="ch-visualization.html#범주형-변수와-색상color-속성의-매핑"><i class="fa fa-check"></i><b>5.3.1</b> 범주형 변수와 색상(<code>color</code>) 속성의 매핑</a></li>
<li class="chapter" data-level="5.3.2" data-path="ch-visualization.html"><a href="ch-visualization.html#범주형-변수와-모양shape-속성의-매핑"><i class="fa fa-check"></i><b>5.3.2</b> 범주형 변수와 모양(<code>shape</code>) 속성의 매핑</a></li>
<li class="chapter" data-level="5.3.3" data-path="ch-visualization.html"><a href="ch-visualization.html#연속형-변수와-크기size-색상color-투명도alpha-속성의-매핑"><i class="fa fa-check"></i><b>5.3.3</b> 연속형 변수와 크기(<code>size</code>), 색상(<code>color</code>), 투명도(<code>alpha</code>) 속성의 매핑</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-commonProblems"><i class="fa fa-check"></i><b>5.4</b> ggplot 명령문을 입력할 때 자주 발생하는 문제들</a></li>
<li class="chapter" data-level="5.5" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-layerAndGeom"><i class="fa fa-check"></i><b>5.5</b> geom 함수와 그래프 계층</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="ch-visualization.html"><a href="ch-visualization.html#geom-함수에서-속성-매핑하기"><i class="fa fa-check"></i><b>5.5.1</b> geom 함수에서 속성 매핑하기</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-facets"><i class="fa fa-check"></i><b>5.6</b> 측면(facets)으로 나누어 그리기</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="ch-visualization.html"><a href="ch-visualization.html#facet_wrap로-일차원-측면-그래프-그리기"><i class="fa fa-check"></i><b>5.6.1</b> <code>facet_wrap()</code>로 일차원 측면 그래프 그리기</a></li>
<li class="chapter" data-level="5.6.2" data-path="ch-visualization.html"><a href="ch-visualization.html#facet_grid로-이차원-측면-그래프-그리기"><i class="fa fa-check"></i><b>5.6.2</b> <code>facet_grid()</code>로 이차원 측면 그래프 그리기</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="ch-visualization.html"><a href="ch-visualization.html#기타-ggplot2의-문법-요소"><i class="fa fa-check"></i><b>5.7</b> 기타 ggplot2의 문법 요소</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="ch-visualization.html"><a href="ch-visualization.html#labelsmodification"><i class="fa fa-check"></i><b>5.7.1</b> 그래프 레이블을 조정하기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html"><i class="fa fa-check"></i><b>6</b> R 고급 데이터 변환</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#데이터의-단순-결합"><i class="fa fa-check"></i><b>6.1</b> 데이터의 단순 결합</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#데이터를-행으로-결합하기"><i class="fa fa-check"></i><b>6.1.1</b> 데이터를 행으로 결합하기</a></li>
<li class="chapter" data-level="6.1.2" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#데이터를-열로-결합하기"><i class="fa fa-check"></i><b>6.1.2</b> 데이터를 열로 결합하기</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#관계형-데이터베이스처럼-데이터-결합하기"><i class="fa fa-check"></i><b>6.2</b> 관계형 데이터베이스처럼 데이터 결합하기</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#inner-join과-outer-join"><i class="fa fa-check"></i><b>6.2.1</b> Inner join과 outer join</a></li>
<li class="chapter" data-level="6.2.2" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#filtering-join"><i class="fa fa-check"></i><b>6.2.2</b> Filtering join</a></li>
<li class="chapter" data-level="6.2.3" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#join을-수행하는-다른-방법들"><i class="fa fa-check"></i><b>6.2.3</b> Join을 수행하는 다른 방법들</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#sec-tidyr"><i class="fa fa-check"></i><b>6.3</b> <code>tidyr</code> 패키지를 이용하여 정돈 데이터 형식으로 바꾸기</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#pivot_longer-여러-열에-걸친-한-변수의-데이터를-하나의-열로-길게-모으기"><i class="fa fa-check"></i><b>6.3.1</b> <code>pivot_longer</code>: 여러 열에 걸친 한 변수의 데이터를 하나의 열로 길게 모으기</a></li>
<li class="chapter" data-level="6.3.2" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#subsec-pivot-wider"><i class="fa fa-check"></i><b>6.3.2</b> <code>pivot_wider</code>: 한 열에 기술된 여러 변수의 데이터를 여러 열로 넓게 펼치기</a></li>
<li class="chapter" data-level="6.3.3" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#seperate-한-셀을-여러-셀로-분리하기"><i class="fa fa-check"></i><b>6.3.3</b> <code>seperate</code>: 한 셀을 여러 셀로 분리하기</a></li>
<li class="chapter" data-level="6.3.4" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#unite-여러-셀의-데이터를-하나의-셀로-병합하기"><i class="fa fa-check"></i><b>6.3.4</b> <code>unite</code>: 여러 셀의 데이터를 하나의 셀로 병합하기</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">경영빅데이터분석 참고자료 - R 기초</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch-dataTransformation" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> 데이터 변환<a href="ch-dataTransformation.html#ch-dataTransformation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>데이터를 분석하려면 데이터를 분석에 적절한 형식으로 변환하는 전처리가 필요하다. 또한 기본적인 분석을 위해서도 데이터를 요약하는 작업이 필요하다. 이 장에서는 정돈 형식의 데이터 프레임을 변환하는 방법을 배운다.</p>
<div id="sec-tidyData" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> 정돈 데이터 (tidy data)<a href="ch-dataTransformation.html#sec-tidyData" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="정돈-데이터-형식의-조건" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> 정돈 데이터 형식의 조건<a href="ch-dataTransformation.html#정돈-데이터-형식의-조건" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>정돈 데이터란 그림 <a href="ch-dataTransformation.html#fig:tidyData">4.1</a>처럼 다음의 조건을 만족하는 데이터 행렬(R에서는 데이터 프레임)의 형식을 의미한다.</p>
<ul>
<li>데이터 행렬의 각 행과 관측(대상)(observations)은 일대일의 관계이다.</li>
<li>데이터 행렬의 각 열과 변수(variables)는 일대일의 관계이다.</li>
<li>측정값(values)은 각 셀과 일대일의 관계이다.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tidyData"></span>
<img src="img/tidyData.png" alt="정돈 데이터" width="100%" />
<p class="caption">
Figure 4.1: 정돈 데이터
</p>
</div>
</div>
<div id="비정돈-데이터-형식" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> 비정돈 데이터 형식<a href="ch-dataTransformation.html#비정돈-데이터-형식" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>현실에서 만나는 많은 데이터가 정돈 데이터 형식이지만, 그렇지 않은 데이터도 자주 볼 수 있다. 그림 <a href="ch-dataTransformation.html#fig:untidyData">4.2</a>의 왼쪽 데이터는 어떤 가상의 감염병에 대해 세 나라의 발생 사례를 월별로 정리한 데이터이다. 이 데이터는 감염 사례라는 변수와 관련된 데이터가 3개의 열에 흩어져 있으므로 비정돈 형식이다. 월별, 년도별 매출처럼 시계열 데이터는 종종 이런 형식으로 데이터가 표현된다. 이러한 방식의 표현은 데이터를 매우 압축적인 방식으로 표현할 수 있고 같은 시간대의 데이터를 비교하기 쉬운 장점이 있다.</p>
<p>그림 <a href="ch-dataTransformation.html#fig:untidyData">4.2</a>의 오른쪽 데이터는 왼쪽 데이터를 정돈 형식으로 변환한 결과이다. 이러한 변환을 하는 방법에 대해서는 <a href="ch-R-Advanced-Data-Mgmt.html#ch-R-Advanced-Data-Mgmt">6</a> 장에서 다룰 것이다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:untidyData"></span>
<img src="img/untidyData.png" alt="비정돈 데이터" width="60%" />
<p class="caption">
Figure 4.2: 비정돈 데이터
</p>
</div>
</div>
<div id="정돈-데이터를-사용하는-이유" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> 정돈 데이터를 사용하는 이유<a href="ch-dataTransformation.html#정돈-데이터를-사용하는-이유" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>그림 <a href="ch-dataTransformation.html#fig:untidyData">4.2</a>를 보면 정돈 형식 데이터가 오히려 비효율적인 방식으로 보이며, 데이터를 한 눈에 비교하기도 어려워 보인다. 그럼에도 정돈 형식의 데이터를 사용하는 이유는 표준화된 데이터 변환 작업을 하기 위해서이다.</p>
<p>한 행이 하나의 관측 대상을, 한 열이 하나의 변수를, 한 셀이 한 값을 나타낸다는 가정이 성립하면, 데이터 변환이나 데이터를 이용한 그래픽 작업을 데이터의 내용에 무관하게 항상 일정한 형식으로 수행할 수 있다.</p>
</div>
</div>
<div id="tidyverse-패키지" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> <code>tidyverse</code> 패키지<a href="ch-dataTransformation.html#tidyverse-패키지" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>tidyverse</code> 패키지는 정돈 데이터 패러다임을 따른 R 패키지들을 한번에 설치하고 적재할 수 있도록 돕는 패키지이다.</p>
<div id="tidyverse-패키지-설치" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> <code>tidyverse</code> 패키지 설치<a href="ch-dataTransformation.html#tidyverse-패키지-설치" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>tidyverse</code> 패키지를 설치하려면 다음 명령을 실행하면 된다. 패키지의 이름은 문자열이므로 따옴표 안에 기술해야 한다.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="ch-dataTransformation.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>또는 RStudio의 Packages 탭에서 [Install]을 클릭한 후 tidyverse라고 입력을 하면 된다. 패키지 설치는 한 번만 수행하면 된다.</p>
</div>
<div id="tidyverse-패키지-적재" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> <code>tidyverse</code> 패키지 적재<a href="ch-dataTransformation.html#tidyverse-패키지-적재" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>tidyverse</code> 패키지가 설치되었으면 패키지를 사용할 때마다 네임스페이스를 적재하고 검색 리스트에 패키지를 포함하는 작업이 필요하다.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> 다음은 <code>tidyverse</code> 패키지를 적재하는 명령어이다. 이번에는 패키지 이름에 따옴표가 없음에 주의한다.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="ch-dataTransformation.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>앞의 명령을 실행하면 정돈 데이터 패러다임을 따르는 여러 개의 패키지가 동시에 적재된다. 그리고 R 기본 패키지와 정돈 데이터 패키지 중에서 이름이 충돌이 나는 것에 대해 보고를 한다. 만약 R 기본 패키지에서 이 함수를 사용하는 경우에는 <code>패키지이름::함수()</code> 형식으로만 사용할 수 있다. 자세한 내용은 R 관련 책을 참조하기 바란다.</p>
</div>
</div>
<div id="sec-dplyr" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> <code>dplyr</code> 패키지와 정돈 데이터의 변환<a href="ch-dataTransformation.html#sec-dplyr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="dplyr-패키지" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> <code>dplyr</code> 패키지<a href="ch-dataTransformation.html#dplyr-패키지" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>정돈 데이터의 변환에는 <code>tidyverse</code> 패키지가 포함하고 있는 <code>dplyr</code> 패키지가 이용된다. 앞에서 <code>tidyverse</code>를 적재하였으면 이미 <code>dplyr</code>이 적재되어 있으므로 다시 적재할 필요가 없다.</p>
</div>
<div id="정돈-데이터-변환의-종류" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> 정돈 데이터 변환의 종류<a href="ch-dataTransformation.html#정돈-데이터-변환의-종류" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>정돈 데이터의 변환은 크게 5가지 변환 작업이 있다.</p>
<ol style="list-style-type: decimal">
<li>행 선택:</li>
</ol>
<ul>
<li><code>filter()</code>: 데이터에서 특정 열의 값이 조건에 맞는 행만 선택한다.</li>
<li><code>slice()</code>: 데이터에서 특정 위치의 행만 선택한다.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>행 정렬</li>
</ol>
<ul>
<li><code>arrange()</code>: 특정 열의 값을 기준으로 데이터의 행을 정렬한다.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>열 선택:</li>
</ol>
<ul>
<li><code>select()</code>: 열의 이름, 위치, 데이터 형식 등으로 일부 열만 데이터에서 선택한다.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>열 추가:</li>
</ol>
<ul>
<li><code>mutate()</code>: 기존 열을 사용하여 새로운 열을 데이터에 추가한다.</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>데이터 요약:</li>
</ol>
<ul>
<li><code>summarize()</code>: 데이터 전체 또는 특정 열을 하나의 통계량으로 요약한다.</li>
<li><code>group_by()</code>: 데이터 요약에만 사용되는 것은 아니나, 그룹별로 데이터를 통계 요약할 때 자주 사용된다.</li>
</ul>
<p>그리고 위의 작업은 <code>group_by()</code> 함수와 같이 사용되어 전체 데이터에서 작업이 수행되는 것이 아니라, 데이터 행을 특정 열의 값을 기준으로 그룹으로 나누어서 그룹별로 데이터 변환 작업이 수행되도록 조정할 수 있다.
다음 그림은 정돈 데이터 변환 함수에 의한 변환 결과를 예시하고 있다.</p>
<p><img src="img/dplyr-verbs2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>이 함수들은 모두 다음과 같은 인터페이스를 가지고 있다.</p>
<ul>
<li>첫 번재 인수로 변환할 데이터프레임을 받는다.</li>
<li>나머지 인수는 데이터프레임에 어떤 변환을 할지를 지정한다. 데이터프레임의 열을 지정할 때 열 이름을 따옴표 없이 변수처럼 사용한다.<br />
</li>
<li>함수의 결과는 변환이 수행된 새로운 데이터프레임이다.</li>
</ul>
<p>일반적으로 데이터의 변환 작업은 위의 6가지 작업이 여러 차례 순서대로 결합하여 진행된다.</p>
</div>
<div id="dplyr-패키지-vs.-r의-기본-기능" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> <code>dplyr</code> 패키지 vs. R의 기본 기능<a href="ch-dataTransformation.html#dplyr-패키지-vs.-r의-기본-기능" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>앞으로 볼 <code>dplyr</code> 패키지의 함수들이 수행하는 작업은 <strong>R</strong>에서 제공하는 기본 함수로도 수행될 수 있다.
특히 <code>filter()</code>, <code>arrange()</code>, <code>select()</code>, <code>mutate()</code> 함수의 작업은 <strong>R</strong> 데이터프레임의 필터링 기능을 사용하면 대체할 수 있으며, <code>summarize()</code>와 <code>group_by()</code> 함수의 작업은 <code>tapply()</code>, <code>aggregate()</code> 등을 사용하면 대체할 수 있다.
그럼에도 불구하고 복잡한 데이터 변환을 수행할 때 R의 기본 기능보다는 <code>dplyr</code> 패키지의 함수들이 선호되는 이유는 다음과 같다.</p>
<ul>
<li><code>dplyr</code> 함수에서는 데이터프레임의 열을 변수처럼 사용할 수 있어서 R의 기본 기능보다 더 짧은 명령문으로 데이터의 조작과 변환이 가능하다.</li>
<li>R의 기본 함수들은 한 함수가 여러 가지 변환을 수행하고 서로의 기능이 중복되는데 반해, <code>dplyr</code> 패키지의 함수는 오직 하나의 기능만을 수행하고 서로 기능이 중복되지 않아서 명령문을 이해하기 쉽다.</li>
<li>R의 기본 함수들이 입력과 출력 형식이 제각각인데 반해, <code>dplyr</code> 패키지의 함수는 공통된 입력과 출력 형식을 사용하므로 여러 단계를 거치는 복잡한 데이터 변환 작업도 <code>dplyr</code> 함수를 파이프 연산자로 연결하여 쉽게 구현할 수 있다.</li>
</ul>
</div>
<div id="mpg-데이터" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> <code>mpg</code> 데이터<a href="ch-dataTransformation.html#mpg-데이터" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>이 장에서는 <code>ggplot2()</code> 패키지에서 제공하는 <code>mpg</code> 데이터를 이용하여 정돈 데이터를 변환하는 함수를 설명한다.</p>
<p>다음 명령을 이용하여 <code>mpg</code> 데이터를 출력해 보자. 화면의 크기에 따라 출력되는 내용이 책과는 조금 다를 수 있다.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="ch-dataTransformation.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mpg</span></code></pre></div>
<pre><code># A tibble: 234 × 11
   manufacturer model      displ  year   cyl trans drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 audi         a4           1.8  1999     4 auto… f        18    29 p     comp…
 2 audi         a4           1.8  1999     4 manu… f        21    29 p     comp…
 3 audi         a4           2    2008     4 manu… f        20    31 p     comp…
 4 audi         a4           2    2008     4 auto… f        21    30 p     comp…
 5 audi         a4           2.8  1999     6 auto… f        16    26 p     comp…
 6 audi         a4           2.8  1999     6 manu… f        18    26 p     comp…
 7 audi         a4           3.1  2008     6 auto… f        18    27 p     comp…
 8 audi         a4 quattro   1.8  1999     4 manu… 4        18    26 p     comp…
 9 audi         a4 quattro   1.8  1999     4 auto… 4        16    25 p     comp…
10 audi         a4 quattro   2    2008     4 manu… 4        20    28 p     comp…
# ℹ 224 more rows</code></pre>
<p><code>mpg</code>는 1999년과 2008년에 미국 EPA에서 조사하여 발표한 자동차 주요 모델별 연비 데이터이다. 데이터는 234 개의 행이 있으며, 각 행은 다음과 같은 변수로 구성되어 있다.</p>
<ul>
<li>manufacturer: 자동차 제조사</li>
<li>model: 자동차 모델명</li>
<li>displ: 자동차 배기량</li>
<li>year: 제조년도</li>
<li>cyl: 엔진 실린더 수</li>
<li>trans: 자동차 트랜스미션 종류</li>
<li>drv: 자동차 구동 방식. f=전륜구동, r=후륜구동, 4=사륜구동</li>
<li>cty: 도심 연비 (마일/갤론)</li>
<li>hwy: 고속도로 연비 (마일/갤론)</li>
<li>fl: 연료 종류</li>
<li>class: 자동차 분류</li>
</ul>
</div>
</div>
<div id="sec-filter" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> <code>filter()</code>로 행 선택하기<a href="ch-dataTransformation.html#sec-filter" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="선택-조건이-하나인-경우" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> 선택 조건이 하나인 경우<a href="ch-dataTransformation.html#선택-조건이-하나인-경우" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>선택 조건이 하나인 경우 다음 형식으로 <code>filter()</code>를 사용한다.</p>
<pre><code>filter(데이터프레임, 조건)</code></pre>
<p>’데이터프레임’에는 <code>filter()</code>를 적용할 데이터 프레임을 ’조건’에는 행 선택 조건을 기술한다. ’조건’은 논리값 벡터이어야 한다. 많은 경우 ’조건’은 다음처럼 변수와 어떤 값을 비교연산자로 비교한다. 다음 예에서 보는 것처럼 <code>dplyr</code> 패키지의 함수들은 첫번째 인수로 데이터프레임을 지정한 후, 나머지 부분에서 그 데이터프레임의 열을 변수처럼 사용할 수 있다.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="ch-dataTransformation.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, manufacturer<span class="sc">==</span><span class="st">&quot;hyundai&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 14 × 11
   manufacturer model   displ  year   cyl trans    drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 hyundai      sonata    2.4  1999     4 auto(l4) f        18    26 r     mids…
 2 hyundai      sonata    2.4  1999     4 manual(… f        18    27 r     mids…
 3 hyundai      sonata    2.4  2008     4 auto(l4) f        21    30 r     mids…
 4 hyundai      sonata    2.4  2008     4 manual(… f        21    31 r     mids…
 5 hyundai      sonata    2.5  1999     6 auto(l4) f        18    26 r     mids…
 6 hyundai      sonata    2.5  1999     6 manual(… f        18    26 r     mids…
 7 hyundai      sonata    3.3  2008     6 auto(l5) f        19    28 r     mids…
 8 hyundai      tiburon   2    1999     4 auto(l4) f        19    26 r     subc…
 9 hyundai      tiburon   2    1999     4 manual(… f        19    29 r     subc…
10 hyundai      tiburon   2    2008     4 manual(… f        20    28 r     subc…
11 hyundai      tiburon   2    2008     4 auto(l4) f        20    27 r     subc…
12 hyundai      tiburon   2.7  2008     6 auto(l4) f        17    24 r     subc…
13 hyundai      tiburon   2.7  2008     6 manual(… f        16    24 r     subc…
14 hyundai      tiburon   2.7  2008     6 manual(… f        17    24 r     subc…</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="ch-dataTransformation.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, cty <span class="sc">&gt;</span> <span class="dv">28</span>)</span></code></pre></div>
<pre><code># A tibble: 3 × 11
  manufacturer model      displ  year   cyl trans  drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 volkswagen   jetta        1.9  1999     4 manua… f        33    44 d     comp…
2 volkswagen   new beetle   1.9  1999     4 manua… f        35    44 d     subc…
3 volkswagen   new beetle   1.9  1999     4 auto(… f        29    41 d     subc…</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="ch-dataTransformation.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, cty <span class="sc">&gt;=</span> <span class="dv">28</span>)</span></code></pre></div>
<pre><code># A tibble: 5 × 11
  manufacturer model      displ  year   cyl trans  drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 honda        civic        1.6  1999     4 manua… f        28    33 r     subc…
2 toyota       corolla      1.8  2008     4 manua… f        28    37 r     comp…
3 volkswagen   jetta        1.9  1999     4 manua… f        33    44 d     comp…
4 volkswagen   new beetle   1.9  1999     4 manua… f        35    44 d     subc…
5 volkswagen   new beetle   1.9  1999     4 auto(… f        29    41 d     subc…</code></pre>
<p>조건을 서술할 때 자주 틀리는 부분이 등호 기호로 <code>=</code>를 사용하는 것이다. R에서 두 값이 같은지를 비교할 때는 <code>==</code>를 사용한다.</p>
<p>다음처럼 조건에 사용되는 변수에 대해 연산을 수행한 후에 그 결과를 비교할 수도 있다.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="ch-dataTransformation.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, cty <span class="sc">*</span> <span class="dv">2</span> <span class="sc">&gt;</span> <span class="dv">60</span>)</span></code></pre></div>
<pre><code># A tibble: 2 × 11
  manufacturer model      displ  year   cyl trans  drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 volkswagen   jetta        1.9  1999     4 manua… f        33    44 d     comp…
2 volkswagen   new beetle   1.9  1999     4 manua… f        35    44 d     subc…</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="ch-dataTransformation.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, <span class="fu">sqrt</span>(cty) <span class="sc">&lt;</span> <span class="fl">3.2</span>)</span></code></pre></div>
<pre><code># A tibble: 5 × 11
  manufacturer model       displ  year   cyl trans drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 dodge        dakota pic…   4.7  2008     8 auto… 4         9    12 e     pick…
2 dodge        durango 4wd   4.7  2008     8 auto… 4         9    12 e     suv  
3 dodge        ram 1500 p…   4.7  2008     8 auto… 4         9    12 e     pick…
4 dodge        ram 1500 p…   4.7  2008     8 manu… 4         9    12 e     pick…
5 jeep         grand cher…   4.7  2008     8 auto… 4         9    12 e     suv  </code></pre>
</div>
<div id="여러-조건을-만족하는-행-추출하기" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> 여러 조건을 만족하는 행 추출하기<a href="ch-dataTransformation.html#여러-조건을-만족하는-행-추출하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>두 개 이상의 조건을 모두 만족하는 행만 뽑아내려면 다음의 문법을 사용한다.</p>
<pre><code>filter(데이터프레임, 조건1, 조건2, ..., 조건n)</code></pre>
<p>다음은 현대에서 생산한 차 중 도심 연비가 20 마일 이상인 차만 추출한 결과이다.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="ch-dataTransformation.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, manufacturer<span class="sc">==</span><span class="st">&quot;hyundai&quot;</span>, cty <span class="sc">&gt;=</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code># A tibble: 4 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
2 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
3 hyundai      tiburon   2    2008     4 manual(m… f        20    28 r     subc…
4 hyundai      tiburon   2    2008     4 auto(l4)  f        20    27 r     subc…</code></pre>
<p>앞의 조건에서 배기량이 2.4 이상인 차만 추출해 보자.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="ch-dataTransformation.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, manufacturer<span class="sc">==</span><span class="st">&quot;hyundai&quot;</span>, cty <span class="sc">&gt;=</span> <span class="dv">20</span>, displ <span class="sc">&gt;=</span> <span class="fl">2.4</span>)</span></code></pre></div>
<pre><code># A tibble: 2 × 11
  manufacturer model  displ  year   cyl trans      drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata   2.4  2008     4 auto(l4)   f        21    30 r     mids…
2 hyundai      sonata   2.4  2008     4 manual(m5) f        21    31 r     mids…</code></pre>
</div>
<div id="논리-연산자로-복합-조건-만들기" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> 논리 연산자로 복합 조건 만들기<a href="ch-dataTransformation.html#논리-연산자로-복합-조건-만들기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>지금까지는 하나의 조건이나 여러 조건을 동시에 만족하는 행을 추출하는 방법을 보았다. 어떤 경우에는 여러 조건 중 하나라도 만족하면 그 행을 추출해야 할 경우가 있다. 이러한 경우에는 <a href="#ch-R-Data-Basic"><strong>??</strong></a> 장에서 배운 논리 연산자를 이용하여 복합 조건을 만들어야 한다.</p>
<p>다음은 OR 연자자인 <code>|</code>를 이용하여 두 조건 중 하나만 만족하여도 행이 추출되도록 하였다.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="ch-dataTransformation.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, model<span class="sc">==</span><span class="st">&quot;sonata&quot;</span> <span class="sc">|</span> cty <span class="sc">&gt;=</span> <span class="dv">28</span>)</span></code></pre></div>
<pre><code># A tibble: 12 × 11
   manufacturer model      displ  year   cyl trans drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 honda        civic        1.6  1999     4 manu… f        28    33 r     subc…
 2 hyundai      sonata       2.4  1999     4 auto… f        18    26 r     mids…
 3 hyundai      sonata       2.4  1999     4 manu… f        18    27 r     mids…
 4 hyundai      sonata       2.4  2008     4 auto… f        21    30 r     mids…
 5 hyundai      sonata       2.4  2008     4 manu… f        21    31 r     mids…
 6 hyundai      sonata       2.5  1999     6 auto… f        18    26 r     mids…
 7 hyundai      sonata       2.5  1999     6 manu… f        18    26 r     mids…
 8 hyundai      sonata       3.3  2008     6 auto… f        19    28 r     mids…
 9 toyota       corolla      1.8  2008     4 manu… f        28    37 r     comp…
10 volkswagen   jetta        1.9  1999     4 manu… f        33    44 d     comp…
11 volkswagen   new beetle   1.9  1999     4 manu… f        35    44 d     subc…
12 volkswagen   new beetle   1.9  1999     4 auto… f        29    41 d     subc…</code></pre>
<p>만약 위의 결과에서 2008년도 데이터만 추출하고 싶다면 어떻게 해야 할까? 다음처럼 두 조건식을 사용하여 첫 번째 조건과 두 번째 조건을 모두 만족하는 결과만 추출할 수도 있고, 하나의 조건식에 AND 연산자인 <code>&amp;</code>를 사용하여 복합 조건식을 사용하여 추출할 수도 있다.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="ch-dataTransformation.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, model<span class="sc">==</span><span class="st">&quot;sonata&quot;</span> <span class="sc">|</span> cty <span class="sc">&gt;=</span> <span class="dv">28</span>, year<span class="sc">==</span><span class="dv">2008</span>)</span></code></pre></div>
<pre><code># A tibble: 4 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
2 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
3 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
4 toyota       corolla   1.8  2008     4 manual(m… f        28    37 r     comp…</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="ch-dataTransformation.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, (model<span class="sc">==</span><span class="st">&quot;sonata&quot;</span> <span class="sc">|</span> cty <span class="sc">&gt;=</span> <span class="dv">28</span>) <span class="sc">&amp;</span> year<span class="sc">==</span><span class="dv">2008</span>)</span></code></pre></div>
<pre><code># A tibble: 4 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
2 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
3 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
4 toyota       corolla   1.8  2008     4 manual(m… f        28    37 r     comp…</code></pre>
<p>단, 복합 조건식에서 AND 연산이 OR 연산보다 우선순위가 있으므로 괄호를 사용하여 연산의 순서가 제대로 되도록 하여야 한다. 괄호가 없으면 AND가 수행된 후 OR가 수행되어 모든 소타나 자동차의 결과가 추출되었음을 볼 수 있다.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="ch-dataTransformation.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, model<span class="sc">==</span><span class="st">&quot;sonata&quot;</span> <span class="sc">|</span> cty <span class="sc">&gt;=</span> <span class="dv">28</span> <span class="sc">&amp;</span> year<span class="sc">==</span><span class="dv">2008</span>)</span></code></pre></div>
<pre><code># A tibble: 8 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  1999     4 auto(l4)  f        18    26 r     mids…
2 hyundai      sonata    2.4  1999     4 manual(m… f        18    27 r     mids…
3 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
4 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
5 hyundai      sonata    2.5  1999     6 auto(l4)  f        18    26 r     mids…
6 hyundai      sonata    2.5  1999     6 manual(m… f        18    26 r     mids…
7 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
8 toyota       corolla   1.8  2008     4 manual(m… f        28    37 r     comp…</code></pre>
</div>
<div id="in-연산자" class="section level3 hasAnchor" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> <code>%in%</code> 연산자<a href="ch-dataTransformation.html#in-연산자" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>만약 조사 년도가 2008년이고, 고속도로 연비가 30 이상이면서, 자동차 모델이 sonata 또는 corolla 또는 jetta인 행을 찾고자 한다면 어떻게 해야 할까?
앞에서 배운 복잡 조건문을 사용하여 다음처럼 수행할 수 있을 것이다.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="ch-dataTransformation.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, year<span class="sc">==</span><span class="dv">2008</span>, hwy <span class="sc">&gt;=</span> <span class="dv">28</span>, model<span class="sc">==</span><span class="st">&quot;sonata&quot;</span> <span class="sc">|</span> model<span class="sc">==</span><span class="st">&quot;corolla&quot;</span> <span class="sc">|</span> model<span class="sc">==</span><span class="st">&quot;jetta&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 9 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
2 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
3 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
4 toyota       corolla   1.8  2008     4 manual(m… f        28    37 r     comp…
5 toyota       corolla   1.8  2008     4 auto(l4)  f        26    35 r     comp…
6 volkswagen   jetta     2    2008     4 auto(s6)  f        22    29 p     comp…
7 volkswagen   jetta     2    2008     4 manual(m… f        21    29 p     comp…
8 volkswagen   jetta     2.5  2008     5 auto(s6)  f        21    29 r     comp…
9 volkswagen   jetta     2.5  2008     5 manual(m… f        21    29 r     comp…</code></pre>
<p>위의 명령은 <code>%in%</code> 연산자를 사용하면 좀 더 간단해 질 수 있다.
<code>%in%</code> 연산자는 어떤 값이 벡터의 요소 중에 하나인지를 판별해 준다.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="ch-dataTransformation.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb323-2"><a href="ch-dataTransformation.html#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">%in%</span> a</span></code></pre></div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="ch-dataTransformation.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">%in%</span> a</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="ch-dataTransformation.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">%in%</span> a</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="ch-dataTransformation.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">%in%</span> a</span></code></pre></div>
<pre><code>[1] FALSE</code></pre>
<p>그러므로 앞에서 수행한 명령은 다음처럼 수행할 수도 있다.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="ch-dataTransformation.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(mpg, year<span class="sc">==</span><span class="dv">2008</span>, hwy <span class="sc">&gt;=</span> <span class="dv">28</span>, model <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;sonata&quot;</span>,<span class="st">&quot;corolla&quot;</span>,<span class="st">&quot;jetta&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 9 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
2 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
3 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
4 toyota       corolla   1.8  2008     4 manual(m… f        28    37 r     comp…
5 toyota       corolla   1.8  2008     4 auto(l4)  f        26    35 r     comp…
6 volkswagen   jetta     2    2008     4 auto(s6)  f        22    29 p     comp…
7 volkswagen   jetta     2    2008     4 manual(m… f        21    29 p     comp…
8 volkswagen   jetta     2.5  2008     5 auto(s6)  f        21    29 r     comp…
9 volkswagen   jetta     2.5  2008     5 manual(m… f        21    29 r     comp…</code></pre>
</div>
</div>
<div id="sec-slice" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> <code>slice()</code>로 행 선택하기<a href="ch-dataTransformation.html#sec-slice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>slice()</code> 함수는 다음 문법을 사용하여 행을 선택한다.</p>
<pre><code>select(데이터프레임, 선택위치1, 선택위치2, ...)</code></pre>
<p><code>선택위치</code>에는 양의 정수 또는 음의 정수 벡터가 지정된다.
양의 정수 벡터가 지정되면 해당 위치의 행이 선택되고, 음의 정수 벡터가 지정되면 해당 위치의 행을 제외한 나머지 행이 선택된다.
그런데 주의할 점은 <code>선택위치</code>에 지정되는 벡터는 모두 양의 정수 벡터이거나 모두 음의 정수 벡터이어야 한다는 것이다.</p>
<p>다음은 2008년도 현대의 자동차 모델만 <code>filter()</code>론 선택하여 <code>a</code>라는 변수에 저장한 후, 이 데이터를 가지고 <code>slice()</code>를 사용하여 여러 위치의 행을 선택해본 예이다.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="ch-dataTransformation.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> a <span class="ot">&lt;-</span> <span class="fu">filter</span>(mpg, manufacturer <span class="sc">==</span> <span class="st">&quot;hyundai&quot;</span>, year <span class="sc">==</span> <span class="dv">2008</span>)</span>
<span id="cb334-2"><a href="ch-dataTransformation.html#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> a</span></code></pre></div>
<pre><code># A tibble: 8 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
2 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
3 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
4 hyundai      tiburon   2    2008     4 manual(m… f        20    28 r     subc…
5 hyundai      tiburon   2    2008     4 auto(l4)  f        20    27 r     subc…
6 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…
7 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
8 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…</code></pre>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="ch-dataTransformation.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">slice</span>(a, <span class="dv">1</span>)   <span class="co"># 1 행 선택</span></span></code></pre></div>
<pre><code># A tibble: 1 × 11
  manufacturer model  displ  year   cyl trans    drv     cty   hwy fl    class  
  &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  
1 hyundai      sonata   2.4  2008     4 auto(l4) f        21    30 r     midsize</code></pre>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="ch-dataTransformation.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">slice</span>(a, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="co"># 1-3 행 선택</span></span></code></pre></div>
<pre><code># A tibble: 3 × 11
  manufacturer model  displ  year   cyl trans      drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata   2.4  2008     4 auto(l4)   f        21    30 r     mids…
2 hyundai      sonata   2.4  2008     4 manual(m5) f        21    31 r     mids…
3 hyundai      sonata   3.3  2008     6 auto(l5)   f        19    28 r     mids…</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="ch-dataTransformation.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">slice</span>(a, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>) <span class="co"># 1-3과 6-7 행 선택</span></span></code></pre></div>
<pre><code># A tibble: 5 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
2 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
3 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
4 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…
5 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…</code></pre>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="ch-dataTransformation.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">slice</span>(a, <span class="sc">-</span><span class="dv">1</span>)  <span class="co"># 1 행 제외</span></span></code></pre></div>
<pre><code># A tibble: 7 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
2 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
3 hyundai      tiburon   2    2008     4 manual(m… f        20    28 r     subc…
4 hyundai      tiburon   2    2008     4 auto(l4)  f        20    27 r     subc…
5 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…
6 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
7 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…</code></pre>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="ch-dataTransformation.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">slice</span>(a, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>))  <span class="co"># 1 행과 4-6 행 제외</span></span></code></pre></div>
<pre><code># A tibble: 4 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
2 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
3 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
4 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…</code></pre>
<div id="slice_sample로-표본-추출하기" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> <code>slice_sample()</code>로 표본 추출하기<a href="ch-dataTransformation.html#slice_sample로-표본-추출하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>데이터를 분석할 때 데이터의 일부 행만 임의로 추출해야하는 경우가 있다.
<code>slice_sample()</code>을 사용하면 데이터에서 원하는 수 또는 비율만큼 행을 임의 추출할 수 있다.
원하는 수만큼 임의 추출하려면 <code>n</code> 인수를 원하는 비율만큼 행을 추출하려면 <code>prop</code> 인수를 사용한다.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="ch-dataTransformation.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">slice_sample</span>(a, <span class="at">n=</span><span class="dv">3</span>) <span class="co"># 데이터에서 3 개의 행을 추출 </span></span></code></pre></div>
<pre><code># A tibble: 3 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      tiburon   2    2008     4 auto(l4)  f        20    27 r     subc…
2 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
3 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="ch-dataTransformation.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">slice_sample</span>(a, <span class="at">prop=</span><span class="fl">0.8</span>) <span class="co"># 데이터에서 80% 행을 추출 </span></span></code></pre></div>
<pre><code># A tibble: 6 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
2 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…
3 hyundai      tiburon   2    2008     4 manual(m… f        20    28 r     subc…
4 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
5 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
6 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…</code></pre>
</div>
<div id="slice_head와-slice_tail" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> <code>slice_head()</code>와 <code>slice_tail()</code><a href="ch-dataTransformation.html#slice_head와-slice_tail" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>데이터의 맨 앞의 행들이나, 맨 뒤의 행을 추출할 때 사용한다.
<code>n</code> 인수를 지정하여 원하는 수만큼의 행을 추출할 수도 있고, <code>prop</code> 인수를 지정하여 원하는 비율만큼의 행을 추출할 수도 있다.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="ch-dataTransformation.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">slice_head</span>(mpg, <span class="at">n=</span><span class="dv">4</span>)  <span class="co"># 데이터의 처음 4 행 추출</span></span></code></pre></div>
<pre><code># A tibble: 4 × 11
  manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class 
  &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; 
1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa…
2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa…
3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compa…
4 audi         a4      2    2008     4 auto(av)   f        21    30 p     compa…</code></pre>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="ch-dataTransformation.html#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">slice_tail</span>(mpg, <span class="at">prop=</span><span class="fl">0.05</span>) <span class="co"># 데이터의 마지막 5% 추출</span></span></code></pre></div>
<pre><code># A tibble: 11 × 11
   manufacturer model      displ  year   cyl trans drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 volkswagen   new beetle   2    1999     4 manu… f        21    29 r     subc…
 2 volkswagen   new beetle   2    1999     4 auto… f        19    26 r     subc…
 3 volkswagen   new beetle   2.5  2008     5 manu… f        20    28 r     subc…
 4 volkswagen   new beetle   2.5  2008     5 auto… f        20    29 r     subc…
 5 volkswagen   passat       1.8  1999     4 manu… f        21    29 p     mids…
 6 volkswagen   passat       1.8  1999     4 auto… f        18    29 p     mids…
 7 volkswagen   passat       2    2008     4 auto… f        19    28 p     mids…
 8 volkswagen   passat       2    2008     4 manu… f        21    29 p     mids…
 9 volkswagen   passat       2.8  1999     6 auto… f        16    26 p     mids…
10 volkswagen   passat       2.8  1999     6 manu… f        18    26 p     mids…
11 volkswagen   passat       3.6  2008     6 auto… f        17    26 p     mids…</code></pre>
</div>
<div id="slice_min과-slice_max" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> <code>slice_min()</code>과 <code>slice_max()</code><a href="ch-dataTransformation.html#slice_min과-slice_max" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>특정 열을 기준으로 가장 값이 작은 행 또는 가장 값이 큰 행을 추출하는 함수이다.
사실 뒤에서 설명할 <code>arrange()</code> 함수를 적용한 후 <code>slice()</code> 함수를 적용하면 같은 효과를 구현할 수 있다.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="ch-dataTransformation.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">slice_min</span>(a, cty, <span class="at">n=</span><span class="dv">2</span>) <span class="co"># cty 열의 값이 가장 작은 2 행 추출</span></span></code></pre></div>
<pre><code># A tibble: 3 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
2 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…
3 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="ch-dataTransformation.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">slice_min</span>(a, hwy, <span class="at">n=</span><span class="dv">2</span>) <span class="co"># hwy 열의 값이 가장 큰 2 행 추출</span></span></code></pre></div>
<pre><code># A tibble: 3 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…
2 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
3 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…</code></pre>
<p>결과에서 보듯이 동률이 있는 경우 동률인 행도 모두 추출되므로 <code>n</code>으로 정한 행의 수보다 많은 행이 추출될 수 있다. 동률인 행인 추출되지 않도록 하려면 <code>with_ties=FALSE</code> 인수를 설정하면 된다.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="ch-dataTransformation.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">slice_min</span>(a, cty, <span class="at">n=</span><span class="dv">2</span>, <span class="at">with_ties =</span> F) <span class="co"># 동률 행을 추출하지 않는다.</span></span></code></pre></div>
<pre><code># A tibble: 2 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
2 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…</code></pre>
</div>
</div>
<div id="sec-arrange" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> <code>arrange()</code>로 행 정렬하기<a href="ch-dataTransformation.html#sec-arrange" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>arrange()</code>는 다음 문법을 사용하여 행을 정렬한다.</p>
<pre><code>arrange(데이터프레임, 첫번째 정렬 기준 변수, 두번째 정렬 기준 변수, ....)</code></pre>
<p><code>filter()</code>와 마찬가지로 첫 번재 인수로 정렬할 데이터 프레임을 전달 받는다. 그리고 두번재 인수부터 정렬의 기준이 되는 변수를 차례로 기술한다. 첫 번째 기준 변수의 값이 같으면, 두 번째 기준 변수를, 두 번째 기준 변수의 값까지 같으면 그 다음 변수를 기준으로 차례로 순서를 결정하여 정렬을 수행한다.</p>
<p>다음은 2008년도 현대의 자동차 모델만 <code>filter()</code>론 선택하여 <code>a</code>라는 변수에 저장한 후, 이 데이터에 대하여 여러 조건으로 정렬을 수행해본 예이다.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="ch-dataTransformation.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> a <span class="ot">&lt;-</span> <span class="fu">filter</span>(mpg, manufacturer <span class="sc">==</span> <span class="st">&quot;hyundai&quot;</span>, year <span class="sc">==</span> <span class="dv">2008</span>)</span>
<span id="cb361-2"><a href="ch-dataTransformation.html#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> a</span></code></pre></div>
<pre><code># A tibble: 8 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
2 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
3 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
4 hyundai      tiburon   2    2008     4 manual(m… f        20    28 r     subc…
5 hyundai      tiburon   2    2008     4 auto(l4)  f        20    27 r     subc…
6 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…
7 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
8 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…</code></pre>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="ch-dataTransformation.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">arrange</span>(a, cyl)</span></code></pre></div>
<pre><code># A tibble: 8 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
2 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
3 hyundai      tiburon   2    2008     4 manual(m… f        20    28 r     subc…
4 hyundai      tiburon   2    2008     4 auto(l4)  f        20    27 r     subc…
5 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
6 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…
7 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
8 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="ch-dataTransformation.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">arrange</span>(a, cyl, cty)</span></code></pre></div>
<pre><code># A tibble: 8 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      tiburon   2    2008     4 manual(m… f        20    28 r     subc…
2 hyundai      tiburon   2    2008     4 auto(l4)  f        20    27 r     subc…
3 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
4 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
5 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
6 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…
7 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…
8 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…</code></pre>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="ch-dataTransformation.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">arrange</span>(a, model, trans)</span></code></pre></div>
<pre><code># A tibble: 8 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
2 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
3 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
4 hyundai      tiburon   2    2008     4 auto(l4)  f        20    27 r     subc…
5 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…
6 hyundai      tiburon   2    2008     4 manual(m… f        20    28 r     subc…
7 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…
8 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…</code></pre>
<div id="desc를-이용하여-내림차순으로-정렬하기" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> <code>desc()</code>를 이용하여 내림차순으로 정렬하기<a href="ch-dataTransformation.html#desc를-이용하여-내림차순으로-정렬하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>앞의 예에서 <code>arrange()</code>는 수치 변수는 올림차순으로 문자 변수는 알파벳 순으로 정렬하는 것을 볼 수 있다. 만약 위의 예에서 내림차순으로, 또는 알파벳 역순으로 정렬을 하고 싶으면 어떻게 하여야 할까? <code>dplyr</code> 패키지는 <code>desc()</code>를 이용하면 된다.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="ch-dataTransformation.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">arrange</span>(a, <span class="fu">desc</span>(cyl))</span></code></pre></div>
<pre><code># A tibble: 8 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
2 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…
3 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
4 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…
5 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
6 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
7 hyundai      tiburon   2    2008     4 manual(m… f        20    28 r     subc…
8 hyundai      tiburon   2    2008     4 auto(l4)  f        20    27 r     subc…</code></pre>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="ch-dataTransformation.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">arrange</span>(a, <span class="fu">desc</span>(cyl), cty)</span></code></pre></div>
<pre><code># A tibble: 8 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
2 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…
3 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…
4 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
5 hyundai      tiburon   2    2008     4 manual(m… f        20    28 r     subc…
6 hyundai      tiburon   2    2008     4 auto(l4)  f        20    27 r     subc…
7 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
8 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…</code></pre>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="ch-dataTransformation.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">arrange</span>(a, model, <span class="fu">desc</span>(trans))</span></code></pre></div>
<pre><code># A tibble: 8 × 11
  manufacturer model   displ  year   cyl trans     drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 manual(m… f        21    31 r     mids…
2 hyundai      sonata    3.3  2008     6 auto(l5)  f        19    28 r     mids…
3 hyundai      sonata    2.4  2008     4 auto(l4)  f        21    30 r     mids…
4 hyundai      tiburon   2.7  2008     6 manual(m… f        16    24 r     subc…
5 hyundai      tiburon   2    2008     4 manual(m… f        20    28 r     subc…
6 hyundai      tiburon   2.7  2008     6 manual(m… f        17    24 r     subc…
7 hyundai      tiburon   2    2008     4 auto(l4)  f        20    27 r     subc…
8 hyundai      tiburon   2.7  2008     6 auto(l4)  f        17    24 r     subc…</code></pre>
<p><code>desc()</code>가 적용된 변수만 내림차순을 기준으로 정렬을 하는 것을 볼 수 있다.</p>
</div>
</div>
<div id="sec-select" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> <code>select()</code>를 이용하여 변수 이름으로 열 선택하기<a href="ch-dataTransformation.html#sec-select" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="변수-이름을-나열하여-선택하기" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> 변수 이름을 나열하여 선택하기<a href="ch-dataTransformation.html#변수-이름을-나열하여-선택하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>select()</code> 함수는 다음처럼 변수 이름을 일일이 나열하여 원하는 열을 선택할 수 있다. R의 기본 문법을 알고 있는 사람들은 데이터 프레임의 인덱싱에서처럼 문자열로 이름을 나열하는 것이 아니라 변수를 사용하듯 따옴표 없이 이름을 나열하는 것에 주의한다.</p>
<pre><code>select(데이터프레임, 변수이름1, 변수이름 2, ....)</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="ch-dataTransformation.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, model, year, cty, hwy)</span></code></pre></div>
<pre><code># A tibble: 8 × 4
  model    year   cty   hwy
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;
1 sonata   2008    21    30
2 sonata   2008    21    31
3 sonata   2008    19    28
4 tiburon  2008    20    28
5 tiburon  2008    20    27
6 tiburon  2008    17    24
7 tiburon  2008    16    24
8 tiburon  2008    17    24</code></pre>
</div>
<div id="변수-이름으로-변수-범위를-선택하기" class="section level3 hasAnchor" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> 변수 이름으로 변수 범위를 선택하기<a href="ch-dataTransformation.html#변수-이름으로-변수-범위를-선택하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>select()</code> 함수는 다음처럼 변수 이름으로 선택할 변수의 범위를 지정할 수 있다.</p>
<pre><code>select(데이터프레임, 범위시작_변수이름:범위종료_변수이름, ...)</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="ch-dataTransformation.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, model<span class="sc">:</span>trans)</span></code></pre></div>
<pre><code># A tibble: 8 × 5
  model   displ  year   cyl trans     
  &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     
1 sonata    2.4  2008     4 auto(l4)  
2 sonata    2.4  2008     4 manual(m5)
3 sonata    3.3  2008     6 auto(l5)  
4 tiburon   2    2008     4 manual(m5)
5 tiburon   2    2008     4 auto(l4)  
6 tiburon   2.7  2008     6 auto(l4)  
7 tiburon   2.7  2008     6 manual(m6)
8 tiburon   2.7  2008     6 manual(m5)</code></pre>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="ch-dataTransformation.html#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, model<span class="sc">:</span>trans, cty<span class="sc">:</span>hwy)</span></code></pre></div>
<pre><code># A tibble: 8 × 7
  model   displ  year   cyl trans        cty   hwy
  &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;int&gt; &lt;int&gt;
1 sonata    2.4  2008     4 auto(l4)      21    30
2 sonata    2.4  2008     4 manual(m5)    21    31
3 sonata    3.3  2008     6 auto(l5)      19    28
4 tiburon   2    2008     4 manual(m5)    20    28
5 tiburon   2    2008     4 auto(l4)      20    27
6 tiburon   2.7  2008     6 auto(l4)      17    24
7 tiburon   2.7  2008     6 manual(m6)    16    24
8 tiburon   2.7  2008     6 manual(m5)    17    24</code></pre>
<p>반대로 다음처럼 변수 이름으로 선택하지 않을 변수의 범위를 지정할 수 있다.</p>
<pre><code>select(데이터프레임, -(범위시작_변수이름:범위종료_변수이름), ...)</code></pre>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="ch-dataTransformation.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, <span class="sc">-</span>(model<span class="sc">:</span>trans))</span></code></pre></div>
<pre><code># A tibble: 8 × 6
  manufacturer drv     cty   hwy fl    class     
  &lt;chr&gt;        &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;     
1 hyundai      f        21    30 r     midsize   
2 hyundai      f        21    31 r     midsize   
3 hyundai      f        19    28 r     midsize   
4 hyundai      f        20    28 r     subcompact
5 hyundai      f        20    27 r     subcompact
6 hyundai      f        17    24 r     subcompact
7 hyundai      f        16    24 r     subcompact
8 hyundai      f        17    24 r     subcompact</code></pre>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="ch-dataTransformation.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, <span class="sc">-</span>(model<span class="sc">:</span>trans), <span class="sc">-</span>manufacturer)</span></code></pre></div>
<pre><code># A tibble: 8 × 5
  drv     cty   hwy fl    class     
  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;     
1 f        21    30 r     midsize   
2 f        21    31 r     midsize   
3 f        19    28 r     midsize   
4 f        20    28 r     subcompact
5 f        20    27 r     subcompact
6 f        17    24 r     subcompact
7 f        16    24 r     subcompact
8 f        17    24 r     subcompact</code></pre>
</div>
<div id="변수-위치로-매칭하여-선택하기" class="section level3 hasAnchor" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> 변수 위치로 매칭하여 선택하기<a href="ch-dataTransformation.html#변수-위치로-매칭하여-선택하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>select()</code> 함수는 R의 기본 인덱싱(필터링)처럼 선택할 열의 위치를 자연수 인덱스 벡터로, 선택하지 않을 열은 음의 정수 인덱스 벡터로 지정할 수도 있다.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="ch-dataTransformation.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="co"># 1 번부터 3번 열 선택</span></span></code></pre></div>
<pre><code># A tibble: 8 × 3
  manufacturer model   displ
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt;
1 hyundai      sonata    2.4
2 hyundai      sonata    2.4
3 hyundai      sonata    3.3
4 hyundai      tiburon   2  
5 hyundai      tiburon   2  
6 hyundai      tiburon   2.7
7 hyundai      tiburon   2.7
8 hyundai      tiburon   2.7</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="ch-dataTransformation.html#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">5</span>) <span class="co"># 1 번부터 3번 열과 5 번 열 선택</span></span></code></pre></div>
<pre><code># A tibble: 8 × 4
  manufacturer model   displ   cyl
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt;
1 hyundai      sonata    2.4     4
2 hyundai      sonata    2.4     4
3 hyundai      sonata    3.3     6
4 hyundai      tiburon   2       4
5 hyundai      tiburon   2       4
6 hyundai      tiburon   2.7     6
7 hyundai      tiburon   2.7     6
8 hyundai      tiburon   2.7     6</code></pre>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="ch-dataTransformation.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, <span class="sc">-</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>)) <span class="co"># 4 번부터 10 번 열 제외하고 선택</span></span></code></pre></div>
<pre><code># A tibble: 8 × 4
  manufacturer model   displ class     
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;     
1 hyundai      sonata    2.4 midsize   
2 hyundai      sonata    2.4 midsize   
3 hyundai      sonata    3.3 midsize   
4 hyundai      tiburon   2   subcompact
5 hyundai      tiburon   2   subcompact
6 hyundai      tiburon   2.7 subcompact
7 hyundai      tiburon   2.7 subcompact
8 hyundai      tiburon   2.7 subcompact</code></pre>
</div>
<div id="변수-이름을-매칭하여-선택하기" class="section level3 hasAnchor" number="4.7.4">
<h3><span class="header-section-number">4.7.4</span> 변수 이름을 매칭하여 선택하기<a href="ch-dataTransformation.html#변수-이름을-매칭하여-선택하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>dplyr</code> 패키지는 다양한 형태로 변수를 선택할 수 있도록 다음의 변수 이름 매칭 함수를 제공한다.
이러한 함수는 변수의 수가 많을 때 매우 유용하다.</p>
<ul>
<li><code>starts_with("abs")</code>: abc로 이름이 시작하는 모든 변수</li>
<li><code>ends_with("abs")</code>: abc로 이름이 끝나는 모든 변수</li>
<li><code>contains("abs")</code>: abc를 이름에 포함하고 있는 모든 변수</li>
<li><code>matches("(.)\\1")</code>: 정규 표현식을 만족하는 이름을 가진 모든 변수</li>
<li><code>num_range("x", 1:3)</code>: “x1”, “x2”, “x3”이라는 이름의 변수</li>
</ul>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="ch-dataTransformation.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, <span class="fu">starts_with</span>(<span class="st">&quot;c&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 8 × 3
    cyl   cty class     
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;     
1     4    21 midsize   
2     4    21 midsize   
3     6    19 midsize   
4     4    20 subcompact
5     4    20 subcompact
6     6    17 subcompact
7     6    16 subcompact
8     6    17 subcompact</code></pre>
</div>
<div id="변수의-형식이나-조건으로-매칭하여-선택하기" class="section level3 hasAnchor" number="4.7.5">
<h3><span class="header-section-number">4.7.5</span> 변수의 형식이나 조건으로 매칭하여 선택하기*<a href="ch-dataTransformation.html#변수의-형식이나-조건으로-매칭하여-선택하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>select()</code> 함수에 <code>where()</code> 함수를 사용하면 해당 조건에 맞는 열만 매칭하여 선택할 수 있다.
<code>where()</code> 함수는 유일한 인수로 함수를 입력받는데, 이 함수는 논리값을 반환하는 함수여야 하며, <code>where()</code> 함수는 각 열에 이 함수를 적용한다.
<code>select()</code> 함수는 <code>where()</code>의 결과가 <code>TRUE</code>인 열만 선택한다.</p>
<p><code>where()</code> 함수가 주로 사용되는 곳은 데이터 형식에 따라 열을 선택할 때이다.
<code>is.</code>로 시작하는 함수들은 어떤 객체가 특정 형식인지를 테스트 한다.
다음 예는 <code>where()</code>와 <code>is.character()</code> 함수를 사용하여 문자열인 열만 선택한 것이다.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="ch-dataTransformation.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, <span class="fu">where</span>(is.character))</span></code></pre></div>
<pre><code># A tibble: 8 × 6
  manufacturer model   trans      drv   fl    class     
  &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     
1 hyundai      sonata  auto(l4)   f     r     midsize   
2 hyundai      sonata  manual(m5) f     r     midsize   
3 hyundai      sonata  auto(l5)   f     r     midsize   
4 hyundai      tiburon manual(m5) f     r     subcompact
5 hyundai      tiburon auto(l4)   f     r     subcompact
6 hyundai      tiburon auto(l4)   f     r     subcompact
7 hyundai      tiburon manual(m6) f     r     subcompact
8 hyundai      tiburon manual(m5) f     r     subcompact</code></pre>
<p>다음 예는 무기명 함수를 이용하여 열이 수치 벡터이고, 열의 평균이 10 이상인 열만 출력한 것이다.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="ch-dataTransformation.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, <span class="fu">where</span>(<span class="cf">function</span>(x) <span class="fu">is.numeric</span>(x) <span class="sc">&amp;&amp;</span> <span class="fu">mean</span>(x) <span class="sc">&gt;=</span> <span class="dv">10</span>))</span></code></pre></div>
<pre><code># A tibble: 8 × 3
   year   cty   hwy
  &lt;int&gt; &lt;int&gt; &lt;int&gt;
1  2008    21    30
2  2008    21    31
3  2008    19    28
4  2008    20    28
5  2008    20    27
6  2008    17    24
7  2008    16    24
8  2008    17    24</code></pre>
<p>또는 다음처럼 purr 형식의 수식으로 무기명 함수를 좀 더 간략하게 정의할 수도 있다.</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="ch-dataTransformation.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, <span class="fu">where</span>(<span class="sc">~</span> <span class="fu">is.numeric</span>(.x) <span class="sc">&amp;&amp;</span> <span class="fu">mean</span>(.x) <span class="sc">&lt;</span> <span class="dv">10</span>))</span></code></pre></div>
<pre><code># A tibble: 8 × 2
  displ   cyl
  &lt;dbl&gt; &lt;int&gt;
1   2.4     4
2   2.4     4
3   3.3     6
4   2       4
5   2       4
6   2.7     6
7   2.7     6
8   2.7     6</code></pre>
</div>
<div id="변수-이름-바꾸기" class="section level3 hasAnchor" number="4.7.6">
<h3><span class="header-section-number">4.7.6</span> 변수 이름 바꾸기<a href="ch-dataTransformation.html#변수-이름-바꾸기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>select()</code> 함수에서 변수 이름을 지정할 때, <code>(새로운 변수 이름)=(기존 변수 이름)</code> 형식으로 지정하면 변수의 이름을 바꿀 수 있다.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="ch-dataTransformation.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, model, <span class="at">city=</span>cty, <span class="at">highway=</span>hwy)</span></code></pre></div>
<pre><code># A tibble: 8 × 3
  model    city highway
  &lt;chr&gt;   &lt;int&gt;   &lt;int&gt;
1 sonata     21      30
2 sonata     21      31
3 sonata     19      28
4 tiburon    20      28
5 tiburon    20      27
6 tiburon    17      24
7 tiburon    16      24
8 tiburon    17      24</code></pre>
<p>만약 전체 데이터를 유지한 상태에서 변수 이름만 변경하려면, <code>rename()</code> 함수를 이용한다. 문법은 <code>select()</code>와 같다.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="ch-dataTransformation.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">rename</span>(a, <span class="at">city=</span>cty, <span class="at">highway=</span>hwy)</span></code></pre></div>
<pre><code># A tibble: 8 × 11
  manufacturer model   displ  year   cyl trans   drv    city highway fl    class
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;int&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 hyundai      sonata    2.4  2008     4 auto(l… f        21      30 r     mids…
2 hyundai      sonata    2.4  2008     4 manual… f        21      31 r     mids…
3 hyundai      sonata    3.3  2008     6 auto(l… f        19      28 r     mids…
4 hyundai      tiburon   2    2008     4 manual… f        20      28 r     subc…
5 hyundai      tiburon   2    2008     4 auto(l… f        20      27 r     subc…
6 hyundai      tiburon   2.7  2008     6 auto(l… f        17      24 r     subc…
7 hyundai      tiburon   2.7  2008     6 manual… f        16      24 r     subc…
8 hyundai      tiburon   2.7  2008     6 manual… f        17      24 r     subc…</code></pre>
</div>
<div id="변수-순서-바꾸기" class="section level3 hasAnchor" number="4.7.7">
<h3><span class="header-section-number">4.7.7</span> 변수 순서 바꾸기<a href="ch-dataTransformation.html#변수-순서-바꾸기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>select()</code> 함수는 나열된 변수의 순서에 따라 새롭게 만들어진 데이터 프레임의 변수의 순서를 조정한다.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="ch-dataTransformation.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, cty, hwy)</span></code></pre></div>
<pre><code># A tibble: 8 × 2
    cty   hwy
  &lt;int&gt; &lt;int&gt;
1    21    30
2    21    31
3    19    28
4    20    28
5    20    27
6    17    24
7    16    24
8    17    24</code></pre>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="ch-dataTransformation.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, hwy, cty)</span></code></pre></div>
<pre><code># A tibble: 8 × 2
    hwy   cty
  &lt;int&gt; &lt;int&gt;
1    30    21
2    31    21
3    28    19
4    28    20
5    27    20
6    24    17
7    24    16
8    24    17</code></pre>
<p>이러한 성질과 <code>everything()</code> 함수를 이용하면 변수의 순서를 쉽게 바꿀 수 있다. <code>everything()</code>은 이미 선택된 변수를 제외한 나머지 변수를 의미한다.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="ch-dataTransformation.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">select</span>(a, cty, hwy, <span class="fu">everything</span>())</span></code></pre></div>
<pre><code># A tibble: 8 × 11
    cty   hwy manufacturer model   displ  year   cyl trans     drv   fl    class
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1    21    30 hyundai      sonata    2.4  2008     4 auto(l4)  f     r     mids…
2    21    31 hyundai      sonata    2.4  2008     4 manual(m… f     r     mids…
3    19    28 hyundai      sonata    3.3  2008     6 auto(l5)  f     r     mids…
4    20    28 hyundai      tiburon   2    2008     4 manual(m… f     r     subc…
5    20    27 hyundai      tiburon   2    2008     4 auto(l4)  f     r     subc…
6    17    24 hyundai      tiburon   2.7  2008     6 auto(l4)  f     r     subc…
7    16    24 hyundai      tiburon   2.7  2008     6 manual(m… f     r     subc…
8    17    24 hyundai      tiburon   2.7  2008     6 manual(m… f     r     subc…</code></pre>
</div>
</div>
<div id="sec-mutate" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> <code>mutate()</code>로 새로운 변수 만들기<a href="ch-dataTransformation.html#sec-mutate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>mutate()</code>는 기존 변수를 이용하여 새로운 변수를 만들어 데이터 프레임의 가장 마지막 열로 추가한다.</p>
<pre><code>mutate(데이터프레임, 새로운_변수=기존_변수_연산식, ....)</code></pre>
<p>다음은 도심 연비와 고속도로 연비의 합과, 평균, 그리고 고속도로 대비 도심 연비의 비율(%)을 계산하여 새로운 열을 만든 예이다.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="ch-dataTransformation.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> b <span class="ot">&lt;-</span> <span class="fu">select</span>(a, <span class="sc">-</span>(cyl<span class="sc">:</span>drv), <span class="sc">-</span>(fl<span class="sc">:</span>class))</span>
<span id="cb413-2"><a href="ch-dataTransformation.html#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> b</span></code></pre></div>
<pre><code># A tibble: 8 × 6
  manufacturer model   displ  year   cty   hwy
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1 hyundai      sonata    2.4  2008    21    30
2 hyundai      sonata    2.4  2008    21    31
3 hyundai      sonata    3.3  2008    19    28
4 hyundai      tiburon   2    2008    20    28
5 hyundai      tiburon   2    2008    20    27
6 hyundai      tiburon   2.7  2008    17    24
7 hyundai      tiburon   2.7  2008    16    24
8 hyundai      tiburon   2.7  2008    17    24</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="ch-dataTransformation.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mutate</span>(b, <span class="at">sum=</span>cty <span class="sc">+</span> hwy)</span></code></pre></div>
<pre><code># A tibble: 8 × 7
  manufacturer model   displ  year   cty   hwy   sum
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1 hyundai      sonata    2.4  2008    21    30    51
2 hyundai      sonata    2.4  2008    21    31    52
3 hyundai      sonata    3.3  2008    19    28    47
4 hyundai      tiburon   2    2008    20    28    48
5 hyundai      tiburon   2    2008    20    27    47
6 hyundai      tiburon   2.7  2008    17    24    41
7 hyundai      tiburon   2.7  2008    16    24    40
8 hyundai      tiburon   2.7  2008    17    24    41</code></pre>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="ch-dataTransformation.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mutate</span>(b, </span>
<span id="cb417-2"><a href="ch-dataTransformation.html#cb417-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">sum=</span>cty <span class="sc">+</span> hwy, </span>
<span id="cb417-3"><a href="ch-dataTransformation.html#cb417-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">mean=</span>(cty <span class="sc">+</span> hwy) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb417-4"><a href="ch-dataTransformation.html#cb417-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">ratio=</span> cty <span class="sc">/</span> hwy <span class="sc">*</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code># A tibble: 8 × 9
  manufacturer model   displ  year   cty   hwy   sum  mean ratio
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1 hyundai      sonata    2.4  2008    21    30    51  25.5  70  
2 hyundai      sonata    2.4  2008    21    31    52  26    67.7
3 hyundai      sonata    3.3  2008    19    28    47  23.5  67.9
4 hyundai      tiburon   2    2008    20    28    48  24    71.4
5 hyundai      tiburon   2    2008    20    27    47  23.5  74.1
6 hyundai      tiburon   2.7  2008    17    24    41  20.5  70.8
7 hyundai      tiburon   2.7  2008    16    24    40  20    66.7
8 hyundai      tiburon   2.7  2008    17    24    41  20.5  70.8</code></pre>
<div id="transmute로-새로운-변수만-남기기" class="section level3 hasAnchor" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> <code>transmute()</code>로 새로운 변수만 남기기<a href="ch-dataTransformation.html#transmute로-새로운-변수만-남기기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>만약 새롭게 만들어진 변수만 데이터에 남기려면 <code>mutate()</code> 대신 <code>transmute()</code>를 사용한다. 문법은 두 함수가 동일하다.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="ch-dataTransformation.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">transmute</span>(b, </span>
<span id="cb419-2"><a href="ch-dataTransformation.html#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">sum=</span>cty <span class="sc">+</span> hwy, </span>
<span id="cb419-3"><a href="ch-dataTransformation.html#cb419-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">mean=</span>(cty <span class="sc">+</span> hwy) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb419-4"><a href="ch-dataTransformation.html#cb419-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">ratio=</span> cty <span class="sc">/</span> hwy <span class="sc">*</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code># A tibble: 8 × 3
    sum  mean ratio
  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1    51  25.5  70  
2    52  26    67.7
3    47  23.5  67.9
4    48  24    71.4
5    47  23.5  74.1
6    41  20.5  70.8
7    40  20    66.7
8    41  20.5  70.8</code></pre>
</div>
<div id="새로운-변수를-만들-때-사용할-수-있는-함수들" class="section level3 hasAnchor" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> 새로운 변수를 만들 때 사용할 수 있는 함수들<a href="ch-dataTransformation.html#새로운-변수를-만들-때-사용할-수-있는-함수들" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>새로운 변수를 생성할 때, 기존 변수와 관련된 수치, 논리, 문자열 연산을 수행할 수 있다. 다음처럼 제조사와 모델을 하나로 합쳐서 새로운 변수를 만들수도 있고, 배기량이 3 이상인지 여부를 나타내는 변수도 만들 수 있다.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="ch-dataTransformation.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mutate</span>(b, <span class="at">newName=</span><span class="fu">paste</span>(manufacturer, model, <span class="at">sep=</span><span class="st">&quot;-&quot;</span>), <span class="at">dis3=</span>displ <span class="sc">&gt;=</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 8 × 8
  manufacturer model   displ  year   cty   hwy newName         dis3 
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;           &lt;lgl&gt;
1 hyundai      sonata    2.4  2008    21    30 hyundai-sonata  FALSE
2 hyundai      sonata    2.4  2008    21    31 hyundai-sonata  FALSE
3 hyundai      sonata    3.3  2008    19    28 hyundai-sonata  TRUE 
4 hyundai      tiburon   2    2008    20    28 hyundai-tiburon FALSE
5 hyundai      tiburon   2    2008    20    27 hyundai-tiburon FALSE
6 hyundai      tiburon   2.7  2008    17    24 hyundai-tiburon FALSE
7 hyundai      tiburon   2.7  2008    16    24 hyundai-tiburon FALSE
8 hyundai      tiburon   2.7  2008    17    24 hyundai-tiburon FALSE</code></pre>
<p>아울러 다음 함수가 새로운 변수를 만들 때 자주 사용된다.</p>
<ul>
<li><code>row_number()</code>: 각 행의 행번호. 각 행에 일련번호를 붙일 때 유용.</li>
<li><code>lead()</code>: 기존 변수를 한 행, 또는 여러 행 빠르게 시작하는 변수</li>
<li><code>lag()</code>: 기존 변수를 한 행, 또는 여러 행 늦게 시작하는 변수</li>
<li><code>cumsum()</code>, <code>cummean()</code>: 누적 합과 평균</li>
<li><code>min_rank()</code>: 가장 작은 것부터 차례대로 크기 순서로 등수를 매기는 함수. <code>desc()</code> 함수를 변수에 적용한 후 등수를 매기면 가장 큰 것부터 순서를 매길 수 있다.</li>
<li><code>dense_rank()</code>, <code>percent_rank()</code>, <code>cume_dist()</code>, <code>ntile()</code> 등도 사용될 수 있다. 자세한 내용은 도움말을 참조하기 바란다.</li>
</ul>
<p>다음의 가상의 상점의 월별 매출 데이터를 사용하여 위에서 설명한 함수의 기능을 살펴보자.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="ch-dataTransformation.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> store <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">month=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">sales=</span><span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">45</span>, <span class="dv">34</span>, <span class="dv">67</span>, <span class="dv">30</span>, <span class="dv">41</span>))</span>
<span id="cb423-2"><a href="ch-dataTransformation.html#cb423-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> store</span></code></pre></div>
<pre><code>  month sales
1     1    23
2     2    45
3     3    34
4     4    67
5     5    30
6     6    41</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="ch-dataTransformation.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mutate</span>(store,</span>
<span id="cb425-2"><a href="ch-dataTransformation.html#cb425-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">before =</span> <span class="fu">lag</span>(sales, <span class="at">n =</span> <span class="dv">1</span>),   <span class="co"># 1 달 전 판매량  </span></span>
<span id="cb425-3"><a href="ch-dataTransformation.html#cb425-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">after =</span> <span class="fu">lead</span>(sales, <span class="at">n =</span> <span class="dv">1</span>),   <span class="co"># 1 달 후 판매량  </span></span>
<span id="cb425-4"><a href="ch-dataTransformation.html#cb425-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">total =</span> <span class="fu">cumsum</span>(sales),        <span class="co"># 누적 판매량</span></span>
<span id="cb425-5"><a href="ch-dataTransformation.html#cb425-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">mean =</span> <span class="fu">cummean</span>(sales),        <span class="co"># 누적 평균 판매량</span></span>
<span id="cb425-6"><a href="ch-dataTransformation.html#cb425-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">rank1 =</span> <span class="fu">min_rank</span>(sales),   <span class="co"># 판매량 순위 (올림차순)</span></span>
<span id="cb425-7"><a href="ch-dataTransformation.html#cb425-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">rank2 =</span> <span class="fu">min_rank</span>(<span class="fu">desc</span>(sales))   <span class="co"># 판매량 순위 (내림차순)</span></span>
<span id="cb425-8"><a href="ch-dataTransformation.html#cb425-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        )</span></code></pre></div>
<pre><code>  month sales before after total  mean rank1 rank2
1     1    23     NA    45    23 23.00     1     6
2     2    45     23    34    68 34.00     5     2
3     3    34     45    67   102 34.00     3     4
4     4    67     34    30   169 42.25     6     1
5     5    30     67    41   199 39.80     2     5
6     6    41     30    NA   240 40.00     4     3</code></pre>
<p>다음은 앞의 예에서 만든 b라는 데이터프레임에 일련번호를 사용하여 id라는 열을 추가한 사례이다.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="ch-dataTransformation.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mutate</span>(b, <span class="at">id =</span> <span class="fu">row_number</span>())</span></code></pre></div>
<pre><code># A tibble: 8 × 7
  manufacturer model   displ  year   cty   hwy    id
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1 hyundai      sonata    2.4  2008    21    30     1
2 hyundai      sonata    2.4  2008    21    31     2
3 hyundai      sonata    3.3  2008    19    28     3
4 hyundai      tiburon   2    2008    20    28     4
5 hyundai      tiburon   2    2008    20    27     5
6 hyundai      tiburon   2.7  2008    17    24     6
7 hyundai      tiburon   2.7  2008    16    24     7
8 hyundai      tiburon   2.7  2008    17    24     8</code></pre>
</div>
</div>
<div id="sec-summarize" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> <code>summarize()</code>로 변수 요약하기<a href="ch-dataTransformation.html#sec-summarize" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<pre><code>summarize(데이터프레임, 요약변수이름=요약함수(변수), ....)</code></pre>
<p><code>summarize()</code> 함수는 데이터프레임을 하나의 행으로 요약한다.
하나의 행으로 요약하기 위하여 변수의 모든 값을 하나의 값으로 통계요약하는 함수를 주로 이용한다.
대표적인 통계요약 함수는 다음과 같다.</p>
<ul>
<li><code>n()</code>: 행의 수를 구한다.</li>
<li><code>sum()</code>: 수치 변수의 합을 구한다.</li>
<li><code>mean()</code>: 수치 변수의 균을 구한다.</li>
<li><code>median()</code>: 수치 변수의 중위수를 구한다.</li>
<li><code>sd()</code>: 수치 변수의 표준편차를 구한다.</li>
<li><code>var()</code>: 수치 변수의 분산을 구한다.</li>
<li><code>min()</code>: 수치 변수의 최소값을 구한다.</li>
<li><code>max()</code>: 수치 변수의 최대값을 구한다.</li>
<li><code>quantile(변수, probs):  수치 변수의</code>probs` 분위수를 구한다.</li>
</ul>
<p>다음은 도심 연비의 데이터 수, 평균, 중위수, 최소값, 최대값을 구한 결과이다.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="ch-dataTransformation.html#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summarize</span>(b, <span class="at">count=</span><span class="fu">n</span>(), <span class="at">mean=</span><span class="fu">mean</span>(cty), <span class="at">med=</span><span class="fu">median</span>(cty), </span>
<span id="cb430-2"><a href="ch-dataTransformation.html#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>           <span class="at">min=</span><span class="fu">min</span>(cty), <span class="at">max=</span><span class="fu">max</span>(cty))</span></code></pre></div>
<pre><code># A tibble: 1 × 5
  count  mean   med   min   max
  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;
1     8  18.9  19.5    16    21</code></pre>
<p>다음처럼 여러 변수에 대하여 통계 요약할 수도 있다.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="ch-dataTransformation.html#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summarize</span>(b, <span class="at">meanCty=</span><span class="fu">mean</span>(cty), <span class="at">meanHwy=</span><span class="fu">mean</span>(hwy),</span>
<span id="cb432-2"><a href="ch-dataTransformation.html#cb432-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>           <span class="at">medianCty=</span><span class="fu">median</span>(cty), <span class="at">medianHqy=</span><span class="fu">median</span>(hwy))</span></code></pre></div>
<pre><code># A tibble: 1 × 4
  meanCty meanHwy medianCty medianHqy
    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1    18.9      27      19.5      27.5</code></pre>
<div id="across로-여려-변수를-요약하기" class="section level3 hasAnchor" number="4.9.1">
<h3><span class="header-section-number">4.9.1</span> <code>across()</code>로 여려 변수를 요약하기*<a href="ch-dataTransformation.html#across로-여려-변수를-요약하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>앞의 예에서 우리는 도심 연비와 고속도로 연비 열에 대해 동일한 통계요약 함수를 적용하였다.
동일한 통계요약 함수를 적용할 열이 한두 개이면 앞의 예처럼 일일이 기술해주면 되지만, 적용해야 할 열이 많아지면 이를 일일이 기술하는 것은 번잡할 뿐만 아니라 오류의 발생 가능성을 높이고 나중에 코드를 변경하기 어렵게 만든다.</p>
<p><code>across()</code> 함수는 <code>select()</code>처럼 열을 선택하여 동일한 함수를 적용할 수 있게 해준다.
<code>across()</code> 함수는 두 개의 주요 인수를 가지고 있다.</p>
<ul>
<li>첫 번째 인수는 <code>.cols</code>로 함수를 적용할 열을 지정한다. 열의 지정은 <code>select()</code> 함수처럼 변수 이름, 위치, 형식으로 지정할 수 있다.</li>
<li>두 번재 인수는 <code>.fns</code>로 열에 적용할 함수를 지정한다.</li>
</ul>
<p><code>across()</code> 함수는 <code>summarize()</code> 함수와 함께 자주 사용되는데 다음처럼 사용된다.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="ch-dataTransformation.html#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summarize</span>(b, <span class="fu">across</span>(<span class="fu">c</span>(cty, hwy), mean))</span></code></pre></div>
<pre><code># A tibble: 1 × 2
    cty   hwy
  &lt;dbl&gt; &lt;dbl&gt;
1  18.9    27</code></pre>
<p>여러 함수를 함께 적용하려면 함수를 리스트로 묶어서 <code>.fns</code> 인수로 전달한다.
이 때 리스트의 요소의 이름을 부여하면 열이름과 해당 요소의 이름으로 결과 열의 이름이 생성된다.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="ch-dataTransformation.html#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summarize</span>(b, <span class="fu">across</span>(<span class="fu">c</span>(cty, hwy), <span class="fu">list</span>(<span class="at">mean=</span>mean, <span class="at">med=</span>median)))</span></code></pre></div>
<pre><code># A tibble: 1 × 4
  cty_mean cty_med hwy_mean hwy_med
     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1     18.9    19.5       27    27.5</code></pre>
<p>결과 열의 이름을 다른 형태로 지정하고 싶으면 <code>.name</code> 인수에 원하는 형식을 함수 이름을 나타내는 <code>{.fn}</code>과 열의 이름을 나타내는 <code>{.col}</code>을 사용하여 설정할 수 있다.
다음은 함수 이름 후에 <code>-</code>가 나온 후 열 이름이 나오도록 한 것이다.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="ch-dataTransformation.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summarize</span>(b, </span>
<span id="cb438-2"><a href="ch-dataTransformation.html#cb438-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">across</span>(<span class="fu">c</span>(cty, hwy), <span class="fu">list</span>(<span class="at">mean=</span>mean, <span class="at">med=</span>median), <span class="at">.names=</span><span class="st">&quot;{.fn}-{.col}&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 1 × 4
  `mean-cty` `med-cty` `mean-hwy` `med-hwy`
       &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
1       18.9      19.5         27      27.5</code></pre>
<p>만약 지금처럼 적용되는 열을 기준으로 정렬되는 것이 아니라 함수 별로 정렬되어 결과가 나오게 하고 싶으면, <code>across()</code> 함수를 각 함수 별로 적용을 한다. 이 때 서로 열 이름이 충돌이 나지 않도록 <code>.names</code> 인수를 설정해 준다.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="ch-dataTransformation.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summarize</span>(b, <span class="fu">across</span>(<span class="fu">c</span>(cty, hwy), mean, <span class="at">.names=</span><span class="st">&quot;mean-{.col}&quot;</span>),</span>
<span id="cb440-2"><a href="ch-dataTransformation.html#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="fu">across</span>(<span class="fu">c</span>(cty, hwy), median, <span class="at">.names=</span><span class="st">&quot;med-{.col}&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 1 × 4
  `mean-cty` `mean-hwy` `med-cty` `med-hwy`
       &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1       18.9         27      19.5      27.5</code></pre>
<p>다음 예는 모든 수치 열에 대하여 표준편차를 구한 것이다.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="ch-dataTransformation.html#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summarize</span>(b, <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sd))</span></code></pre></div>
<pre><code># A tibble: 1 × 4
  displ  year   cty   hwy
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 0.427     0  1.96  2.78</code></pre>
</div>
</div>
<div id="sec-groupBy" class="section level2 hasAnchor" number="4.10">
<h2><span class="header-section-number">4.10</span> <code>group_by()</code>로 그룹별로 요약하기<a href="ch-dataTransformation.html#sec-groupBy" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<pre><code>group_by(데이터프레임, 그룹기준변수1, 그룹기준변수2, ...)</code></pre>
<p><code>group_by()</code> 함수는 기준이 되는 변수의 구분되는 값에 따라 데이터를 그룹화한다. 그룹화된 결과를 <code>summarize()</code> 함수에 전달하면 그룹별로 요약된 결과를 출력한다.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="ch-dataTransformation.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> byModel <span class="ot">&lt;-</span> <span class="fu">group_by</span>(b, model)</span>
<span id="cb445-2"><a href="ch-dataTransformation.html#cb445-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summarize</span>(byModel, <span class="at">count=</span><span class="fu">n</span>(), <span class="at">mean=</span><span class="fu">mean</span>(cty), <span class="at">sd=</span><span class="fu">sd</span>(cty))</span></code></pre></div>
<pre><code># A tibble: 2 × 4
  model   count  mean    sd
  &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1 sonata      3  20.3  1.15
2 tiburon     5  18    1.87</code></pre>
<p>그룹화된 결과를 출력해 보면, 원 데이터인 <code>b</code>와 같아보이는데, 출력시 model 변수로 그룹화 되어 있다는 것이 같이 출력된다.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="ch-dataTransformation.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> byModel</span></code></pre></div>
<pre><code># A tibble: 8 × 6
# Groups:   model [2]
  manufacturer model   displ  year   cty   hwy
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1 hyundai      sonata    2.4  2008    21    30
2 hyundai      sonata    2.4  2008    21    31
3 hyundai      sonata    3.3  2008    19    28
4 hyundai      tiburon   2    2008    20    28
5 hyundai      tiburon   2    2008    20    27
6 hyundai      tiburon   2.7  2008    17    24
7 hyundai      tiburon   2.7  2008    16    24
8 hyundai      tiburon   2.7  2008    17    24</code></pre>
<p>변수를 여러 개를 조합하여 그룹화를 할 수도 있다.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="ch-dataTransformation.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> byModel <span class="ot">&lt;-</span> <span class="fu">group_by</span>(a, model, cyl)</span>
<span id="cb449-2"><a href="ch-dataTransformation.html#cb449-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summarize</span>(byModel, <span class="at">count=</span><span class="fu">n</span>(), <span class="at">mean=</span><span class="fu">mean</span>(cty))</span></code></pre></div>
<pre><code>`summarise()` has grouped output by &#39;model&#39;. You can override using the
`.groups` argument.</code></pre>
<pre><code># A tibble: 4 × 4
# Groups:   model [2]
  model     cyl count  mean
  &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
1 sonata      4     2  21  
2 sonata      6     1  19  
3 tiburon     4     2  20  
4 tiburon     6     3  16.7</code></pre>
<p>여러 변수로 그룹화를 하면 <code>summarize()</code> 함수는 그룹별로 하나의 행만 생성이 되었으면 결과에서 마지막 그룹을 제거한다.
위의 결과에서는 model과 cyl의 값의 조합에 대하여 하나의 행만 생성되었으므로, 마지막 그룹 변수인 cyl와 관련된 그룹은 사라지고, model과 관련된 그룹만 남는다.
출력된 결과와 메시지에서 이를 확인할 수 있다.
<code>summarize()</code> 함수의 <code>.groups</code> 인수를 사용하면 <code>summarize()</code> 후에 그룹을 유지할지, 모두 없앨지 등을 조정할 수 있다. 관심있는 독자는 <code>summarize()</code> 함수의 도움말을 참조하기 바란다.</p>
<div id="group_by로-그룹별로-새-변수-추가하기" class="section level3 hasAnchor" number="4.10.1">
<h3><span class="header-section-number">4.10.1</span> <code>group_by()</code>로 그룹별로 새 변수 추가하기<a href="ch-dataTransformation.html#group_by로-그룹별로-새-변수-추가하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>group_by()</code>는 <code>summarize()</code>와 함께 자주 사용되지만, <code>mutate()</code>나 <code>filter()</code> 등의 다른 <code>dplyr</code> 함수와 함께 사용될 수 있다.</p>
<p>다음은 <code>mutate()</code>로 전체 대이터에 대하여 고속도로 연비 순으로 순위를 매기는 것과, <code>group_bu()</code>와 함께 사용하여 모델별로 고속도로 연비의 순위를 매긴 것을 비교하여 보여 주고 있다.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="ch-dataTransformation.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mutate</span>(b, <span class="at">rank=</span><span class="fu">min_rank</span>(<span class="fu">desc</span>(hwy)))  <span class="co"># 전체 데이터에서 고속도로 연비 순위 매기기</span></span></code></pre></div>
<pre><code># A tibble: 8 × 7
  manufacturer model   displ  year   cty   hwy  rank
  &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1 hyundai      sonata    2.4  2008    21    30     2
2 hyundai      sonata    2.4  2008    21    31     1
3 hyundai      sonata    3.3  2008    19    28     3
4 hyundai      tiburon   2    2008    20    28     3
5 hyundai      tiburon   2    2008    20    27     5
6 hyundai      tiburon   2.7  2008    17    24     6
7 hyundai      tiburon   2.7  2008    16    24     6
8 hyundai      tiburon   2.7  2008    17    24     6</code></pre>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="ch-dataTransformation.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mutate</span>(byModel, <span class="at">rank=</span><span class="fu">min_rank</span>(<span class="fu">desc</span>(hwy)))  <span class="co"># 모델 별로 고속도로 연비 순위 매기기</span></span></code></pre></div>
<pre><code># A tibble: 8 × 12
# Groups:   model, cyl [4]
  manufacturer model displ  year   cyl trans drv     cty   hwy fl    class  rank
  &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt;
1 hyundai      sona…   2.4  2008     4 auto… f        21    30 r     mids…     2
2 hyundai      sona…   2.4  2008     4 manu… f        21    31 r     mids…     1
3 hyundai      sona…   3.3  2008     6 auto… f        19    28 r     mids…     1
4 hyundai      tibu…   2    2008     4 manu… f        20    28 r     subc…     1
5 hyundai      tibu…   2    2008     4 auto… f        20    27 r     subc…     2
6 hyundai      tibu…   2.7  2008     6 auto… f        17    24 r     subc…     1
7 hyundai      tibu…   2.7  2008     6 manu… f        16    24 r     subc…     1
8 hyundai      tibu…   2.7  2008     6 manu… f        17    24 r     subc…     1</code></pre>
</div>
<div id="count로-개수-세기" class="section level3 hasAnchor" number="4.10.2">
<h3><span class="header-section-number">4.10.2</span> <code>count()</code>로 개수 세기<a href="ch-dataTransformation.html#count로-개수-세기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>앞의 예에서 모델 별로 데이터 개수만을 세려면 다음과 같은 명령어를 사용하면 된다.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="ch-dataTransformation.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> byModel <span class="ot">&lt;-</span> <span class="fu">group_by</span>(b, model)</span>
<span id="cb456-2"><a href="ch-dataTransformation.html#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summarise</span>(byModel, <span class="at">n=</span><span class="fu">n</span>())</span></code></pre></div>
<pre><code># A tibble: 2 × 2
  model       n
  &lt;chr&gt;   &lt;int&gt;
1 sonata      3
2 tiburon     5</code></pre>
<p>그런데 이렇게 특정 열을 기준으로 값의 빈도를 세는 작업은 매우 빈번히 수행되므로, <code>count()</code> 함수는 위에서 두 단계로 수행해야 하는 명령을 하나의 명령만으로 수행할 수 있게 해 준다.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="ch-dataTransformation.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">count</span>(b, model)</span></code></pre></div>
<pre><code># A tibble: 2 × 2
  model       n
  &lt;chr&gt;   &lt;int&gt;
1 sonata      3
2 tiburon     5</code></pre>
<p>다음은 <code>mpg 데이터에서</code>class` 열의 각 값의 빈도를 센 결과이다.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="ch-dataTransformation.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">count</span>(mpg, class)</span></code></pre></div>
<pre><code># A tibble: 7 × 2
  class          n
  &lt;chr&gt;      &lt;int&gt;
1 2seater        5
2 compact       47
3 midsize       41
4 minivan       11
5 pickup        33
6 subcompact    35
7 suv           62</code></pre>
<p>만약 빈도가 큰 값일수록 위에 표시되게 하려면 다음처럼 <code>sort=TRUE</code> 인수를 설정한다.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="ch-dataTransformation.html#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">count</span>(mpg, class, <span class="at">sort=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code># A tibble: 7 × 2
  class          n
  &lt;chr&gt;      &lt;int&gt;
1 suv           62
2 compact       47
3 midsize       41
4 subcompact    35
5 pickup        33
6 minivan       11
7 2seater        5</code></pre>
<p><code>count()</code>는 하나의 열뿐만 아니라 여러 열을 사용하여 빈도를 계산할 수 있다. 다음은 <code>class</code>와 <code>cyl</code>의 값의 가능한 조합별로 빈도를 계산한 결과이다.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="ch-dataTransformation.html#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">count</span>(mpg, class, cyl, <span class="at">sort=</span>T)</span></code></pre></div>
<pre><code># A tibble: 19 × 3
   class        cyl     n
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt;
 1 suv            8    38
 2 compact        4    32
 3 midsize        6    23
 4 subcompact     4    21
 5 pickup         8    20
 6 midsize        4    16
 7 suv            6    16
 8 compact        6    13
 9 minivan        6    10
10 pickup         6    10
11 suv            4     8
12 subcompact     6     7
13 2seater        8     5
14 subcompact     8     5
15 pickup         4     3
16 compact        5     2
17 midsize        8     2
18 subcompact     5     2
19 minivan        4     1</code></pre>
<p>이외에도 <code>count()</code> 함수는 빈도를 계산할 때, <code>wt</code> 인수를 사용하여 행의 개수로 빈도를 계산하는 것이 아니라 해당 행의 특정 열의 값의 합으로 빈도를 계산할 수도 있다.
관심있는 독자는 <code>count()</code> 함수의 도움말을 찾아보기 바란다.</p>
</div>
</div>
<div id="sec-pipeOperator" class="section level2 hasAnchor" number="4.11">
<h2><span class="header-section-number">4.11</span> <code>%&gt;%</code> 파이프 연산자<a href="ch-dataTransformation.html#sec-pipeOperator" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="여러-단계를-거쳐-데이터를-변환할-때" class="section level3 hasAnchor" number="4.11.1">
<h3><span class="header-section-number">4.11.1</span> 여러 단계를 거쳐 데이터를 변환할 때<a href="ch-dataTransformation.html#여러-단계를-거쳐-데이터를-변환할-때" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>mpg</code> 데이터에서 조사 연도와 모델 별로 데이터 수와 도심 연비의 평균을 구한 후, 평균이 22 이상인 모델로 이루어진 행을 추출하려고 한다. 이를 수행하려면 다음처럼 변수를 이용하여 결과를 차례로 전달하거나, 함수를 결합하여 한 문장에 사용하여야 한다.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="ch-dataTransformation.html#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> byModel <span class="ot">&lt;-</span> <span class="fu">group_by</span>(mpg, model, year)</span>
<span id="cb466-2"><a href="ch-dataTransformation.html#cb466-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> meanCty <span class="ot">&lt;-</span> <span class="fu">summarize</span>(byModel, <span class="at">count=</span><span class="fu">n</span>(), <span class="at">mean=</span><span class="fu">mean</span>(cty))</span></code></pre></div>
<pre><code>`summarise()` has grouped output by &#39;model&#39;. You can override using the
`.groups` argument.</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="ch-dataTransformation.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(meanCty, mean <span class="sc">&gt;=</span> <span class="dv">22</span>)</span></code></pre></div>
<pre><code># A tibble: 5 × 4
# Groups:   model [3]
  model       year count  mean
  &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
1 civic       1999     5  24.8
2 civic       2008     4  24  
3 corolla     1999     3  24.7
4 corolla     2008     2  27  
5 new beetle  1999     4  26  </code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="ch-dataTransformation.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">filter</span>(<span class="fu">summarize</span>(<span class="fu">group_by</span>(mpg, model, year), <span class="at">count=</span><span class="fu">n</span>(), <span class="at">mean=</span><span class="fu">mean</span>(cty)), mean <span class="sc">&gt;=</span> <span class="dv">22</span>)</span></code></pre></div>
<pre><code>`summarise()` has grouped output by &#39;model&#39;. You can override using the
`.groups` argument.</code></pre>
<pre><code># A tibble: 5 × 4
# Groups:   model [3]
  model       year count  mean
  &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
1 civic       1999     5  24.8
2 civic       2008     4  24  
3 corolla     1999     3  24.7
4 corolla     2008     2  27  
5 new beetle  1999     4  26  </code></pre>
<p>전자는 불피요하게 중간 결과를 저장할 변수를 만들어야 하고, 후자는 복잡하여 이 명령이 무엇을 하는 명령어인지 쉽게 파악하기 힘들다. 또한 중첩된 괄호 때문에 오류가 발생하기 쉽다.</p>
</div>
<div id="파이프-연산자" class="section level3 hasAnchor" number="4.11.2">
<h3><span class="header-section-number">4.11.2</span> 파이프 연산자<a href="ch-dataTransformation.html#파이프-연산자" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>파이프 연산자는 데이터 변환이 여러 단계를 거칠 때 불필요한 변수의 생성 없이도 함수 간에 중간 데이터를 전달할 수 있게 해 준다.</p>
<p>파이프 연산자는 앞의 함수의 결과를 뒤 함수의 첫 번째 인수로 전달해 준다. 파이프 연산자를 사용할 때는 그러므로 첫 번째 인수는 생략하여 기술한다.
파이프 연산자로는 <code>magrittr</code> 패키지가 제공하는 <code>%&gt;%</code> 연산자를 사용할 수도 있고, <strong>R</strong> 4.1.0 버전부터 도입된 기본 기능에 포함된 <code>|&gt;</code> 연산자를 사용할 수도 있다.
여기서는 <strong>R</strong> 버전이 낮은 사용자에게도 동일하게 적용될 수 있도록 <code>%&gt;%</code> 연산자를 사용하도록 한다.
이 연산자는 <code>tidyverse</code> 패키지를 적재하였으면 사용할 수 있다.</p>
<p>다음은 앞의 예와 동일한 예를 파이프 연산자를 사용하여 수행한 결과이다.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="ch-dataTransformation.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mpg <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(model, year) <span class="sc">%&gt;%</span> </span>
<span id="cb473-2"><a href="ch-dataTransformation.html#cb473-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">summarize</span>(<span class="at">count=</span><span class="fu">n</span>(), <span class="at">mean=</span><span class="fu">mean</span>(cty)) <span class="sc">%&gt;%</span></span>
<span id="cb473-3"><a href="ch-dataTransformation.html#cb473-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">filter</span>(mean <span class="sc">&gt;=</span> <span class="dv">22</span>)</span></code></pre></div>
<pre><code>`summarise()` has grouped output by &#39;model&#39;. You can override using the
`.groups` argument.</code></pre>
<pre><code># A tibble: 5 × 4
# Groups:   model [3]
  model       year count  mean
  &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
1 civic       1999     5  24.8
2 civic       2008     4  24  
3 corolla     1999     3  24.7
4 corolla     2008     2  27  
5 new beetle  1999     4  26  </code></pre>
<p>불필요하게 데이터를 기술하는 부분이 사라져서 각 단계에서 수행하는 작업이 무엇인지 명확하게 들어나고 불필요한 중간 변수를 만들지 않아도 되므로 파이프 연산자는 매우 편리하다.</p>
<p>그런데 파이프 연산자를 사용하려면 앞의 함수의 결과가 뒤의 함수의 첫 인수로 사용하기 적절한 형태이어야 한다. <code>dplyr</code> 패키지의 주요 함수들은 정돈 데이터 형식으로 데이터의 결과를 반환하고, 첫 인수가 정돈 데이터 형식의 데이터로 간주한다.</p>
<p>파이프 연산자를 사용할 때 주의할 점은 여러 줄로 명령을 기술할 때, 파이프 연산자로 중간 문장이 종료되어야 한다는 것이다. 그래야 아직 문장이 완료되지 않았다는 것을 이해하여 다음 단계의 명령이 입력되기를 기다린다. 다음처럼 기술하면 R은 명령 입력이 중간에 완료된 것으로 보고 잘못된 결과를 출력한다.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="ch-dataTransformation.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> b <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb476-2"><a href="ch-dataTransformation.html#cb476-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">summarize</span>(<span class="at">count=</span><span class="fu">n</span>(), <span class="at">mean=</span><span class="fu">mean</span>(cty)) </span>
<span id="cb476-3"><a href="ch-dataTransformation.html#cb476-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mean <span class="sc">&gt;=</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>Error: &lt;text&gt;:3:3: 예기치 않은 SPECIAL입니다
2:   summarize(count=n(), mean=mean(cty)) 
3:   %&gt;%
     ^</code></pre>
<p><code>%&gt;%</code> 연산자 이외에도 연산 결과를 출력도 하고 결과를 반환하고 싶을 때 사용하는 <code>%T&gt;%</code> 연산자, 입력된 객체에 결과를 재할당하고 싶을 때 사용하는 <code>%&lt;&gt;%</code> 연산자 등도 있으니 관심있는 독자는 도움말을 살펴보기 바란다.</p>
</div>
<div id="ungroup" class="section level3 hasAnchor" number="4.11.3">
<h3><span class="header-section-number">4.11.3</span> <code>ungroup()</code><a href="ch-dataTransformation.html#ungroup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>파이프 연산자를 사용하여 데이터를 전달하다 보면 데이터가 그룹화 된 것을 중간 단계에서 해제하고 싶을 때가 있다. 이 경우에는 <code>ungroup()</code> 명령을 사용한다.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="ch-dataTransformation.html#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> byModel <span class="ot">&lt;-</span> b <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(model) </span>
<span id="cb478-2"><a href="ch-dataTransformation.html#cb478-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> byModel <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">count=</span><span class="fu">n</span>())</span></code></pre></div>
<pre><code># A tibble: 2 × 2
  model   count
  &lt;chr&gt;   &lt;int&gt;
1 sonata      3
2 tiburon     5</code></pre>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="ch-dataTransformation.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> byModel <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">count=</span><span class="fu">n</span>())</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  count
  &lt;int&gt;
1     8</code></pre>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>반드시 필요한 작업은 아니다. 그렇지만 실행하는 것이 작업할 때 매우 편리하므로 필수적인 작업으로 생각하는 것이 좋다.<a href="ch-dataTransformation.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-R-Data-Structure.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["biztext-book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
